<html lang="ja">
 <head>
  <meta content="origin" name="referrer"/>
  <!-- Global site tag (gtag.js) - Google Analytics -->
  <script async="" src="https://www.googletagmanager.com/gtag/js?id=G-HMG13DJCGJ">
  </script>
  <script>
   window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-HMG13DJCGJ');
  </script>
  <meta charset="utf-8">
   <meta content="捨てメアド,捨てアド,フリーメール,使い捨てアドレス,メルアド作成,登録用アドレス" name="keywords"/>
   <meta content="多機能フリーメールサービス。メールアドレスは同時にいくつでも保有でき、期限もありません。登録も不要です。" name="description"/>
   <meta content="summary" name="twitter:card">
    <meta content="@kukusama" name="twitter:site">
     <meta content="捨てメアド【メルアドぽいぽい】" name="twitter:title"/>
     <meta content="多機能フリーメールサービス。メールアドレスは同時にいくつでも保有でき、期限もありません。登録も不要です。" name="twitter:description"/>
     <meta content="https://m.kuku.lu/img/icon1024_ios.png" name="twitter:image"/>
     <meta content="https://m.kuku.lu/" property="og:url"/>
     <meta content="捨てメアド【メルアドぽいぽい】" property="og:title"/>
     <meta content="多機能フリーメールサービス。メールアドレスは同時にいくつでも保有でき、期限もありません。登録も不要です。" property="og:description"/>
     <meta content="https://m.kuku.lu/img/icon1024_ios.png" property="og:image"/>
     <title>
      捨てメアド【メルアドぽいぽい】
     </title>
     <meta content="index, follow" name="robots"/>
     <meta content="text/html; charset=utf-8" http-equiv="Content-Type"/>
     <meta content="text/css" http-equiv="Content-Style-Type"/>
     <meta content="dark light" name="color-scheme"/>
     <link href="favicon.ico" rel="shortcut icon" type="image/x-icon"/>
     <script src="js/base64.js">
     </script>
     <link href="css/themes/mailnow.min.css?v=20" rel="stylesheet">
      <link href="css/themes/jquery.mobile.icons.min.css" rel="stylesheet"/>
      <link href="js/jquery.mobile-1.4.5/jquery.mobile.structure-1.4.5.min.css" rel="stylesheet"/>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.2.4/jquery.min.js">
      </script>
      <script>
       $(document).bind('mobileinit', function(){
	$.mobile.useFastClick = false;
	$.mobile.ajaxEnabled = false;
	$.mobile.pushStateEnabled = false;
	$.mobile.hashListeningEnabled = false;
});
      </script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquerymobile/1.4.5/jquery.mobile.min.js">
      </script>
      <script src="js/jquery.inview.min.js">
      </script>
      <script src="js/jstz.min.js">
      </script>
      <style type="text/css">
       <!--

html{
	scrollbar-gutter: stable;
}

::-webkit-scrollbar{
	width: 10px;
}
::-webkit-scrollbar-track{
	background: #fff;
	border-left: solid 1px #ececec;
}
::-webkit-scrollbar-thumb{
	background: #ccc;
	border-radius: 10px;
	box-shadow: inset 0 0 0 2px #fff;
}

.wordbreak{
    word-break: break-all;
    word-wrap: break-word;
    overflow-wrap: anywhere;
    line-break: anywhere;
}

.oauth_button_apple, .oauth_button_google, .oauth_button_qrcode{
	border-radius:6px;
	padding:10px;
	margin:5px;
	border-radius:6px;
	cursor:pointer;
}
.oauth_button_apple{
	background-color:black;
}
.oauth_button_apple img{
}
.oauth_button_google{
	background-color:rgba(128,128,128,0.1);
}
.oauth_button_qrcode{
	background-color:rgba(128,128,128,0.1);
}

.fade_bg{
	background-color:rgba(128,128,128,0.1);
}

.autoicon{oauth_button_
}

.unsel{
	-webkit-user-select: none;
	-moz-user-select: none;
	-ms-user-select: none;
	-khtml-user-select: none;
	user-select: none;
}

.ui-page-theme-a a, html .ui-bar-a a, html .ui-body-a a, html body .ui-group-theme-a a {
	font-weight: normal;
}
.ui-btn, label.ui-btn {
	font-weight: normal;
}

.ui-mobile label, .ui-controlgroup-label {
	margin:0;
}

.ui-btn{
	white-space: normal;
}

.simplebutton{
	background-color:white !important;
	border:white !important;
	color:#0068A7 !important;
	cursor:pointer;
}

.noborderinput{
	background-color: white;
	color: black;
}

.titletext{
  color: #666666;
}

.ui-popup {
    border-radius: 5px;
    border-color: rgba(0,0,0,0.1) !important;
    overflow: auto;
}

.ui-checkbox, .ui-radio {
    margin: .3em 0;
    border-radius:4px;
}

.ui-popup-container {
	margin: auto;
    left: 0 !important;
    right: 0 !important;
    width: 500px;
    max-width: 100%;
    min-width: 60%;
}

.ui-listview>.ui-li-static, .ui-listview>.ui-li-divider, .ui-listview>li>a.ui-btn{
	}

.ui-input-text input, .ui-input-search input {
	}

.ui-input-text {
    height: 100%;
    box-sizing: border-box;
}

.ui-input-search:after {
	}

.ui-checkbox .ui-btn, .ui-radio .ui-btn {
	}

.ui-popup-screen.in {
    opacity: .6;
}
.ui-overlay-b, .ui-page-theme-b, .ui-page-theme-b .ui-panel-wrapper {
    background-color: black;
}
.ui-overlay-shadow {
    -webkit-box-shadow: 0 2.5rem 2rem -2rem hsl(200 50% 20% / 40%);
    -moz-box-shadow: 0 2.5rem 2rem -2rem hsl(200 50% 20% / 40%);
    box-shadow: 0 2.5rem 2rem -2rem hsl(200 50% 20% / 40%);
}

.ui-overlay-a .ui-focus, .ui-overlay-b .ui-focus, .ui-page-theme-a .ui-btn:focus {
    -webkit-box-shadow: 0 0 2px rgba(0,0,0,.1);
    -moz-box-shadow: 0 0 2px rgba(0,0,0,.1);
    box-shadow: 0 0 2px rgba(0,0,0,.1);
}

.ui-page-theme-a .ui-btn:focus, html .ui-bar-a .ui-btn:focus, html .ui-body-a .ui-btn:focus, html body .ui-group-theme-a .ui-btn:focus, html head + body .ui-btn.ui-btn-a:focus, .ui-page-theme-a .ui-focus, html .ui-bar-a .ui-focus, html .ui-body-a .ui-focus, html body .ui-group-theme-a .ui-focus, html head + body .ui-btn-a.ui-focus, html head + body .ui-body-a.ui-focus {
    -webkit-box-shadow: 0 0 2px rgba(0,0,0,.1);
    -moz-box-shadow: 0 0 2px rgba(0,0,0,.1);
    box-shadow: 0 0 2px rgba(0,0,0,.1);
}

.ui-input-text, .ui-input-search {
	margin: 0;
}

.ui-mobile .ui-page-active {
	overflow: visible;
	overflow-x: visible;
}

.ui-body-a, .ui-page-theme-a .ui-body-inherit, html .ui-bar-a .ui-body-inherit, html .ui-body-a .ui-body-inherit, html body .ui-group-theme-a .ui-body-inherit, html .ui-panel-page-container-a {
	text-shadow: 0px 0px 0px rgba(0,0,0,0) !important;
}
	
.floatbutton {
	padding:0px;
	padding-top:0px;
	margin:0px;
	text-align:center;
	position:absolute;
	z-index:1000;
}
@supports (position: sticky) or (position: -webkit-sticky) {
	.floatbutton {
		position:-webkit-sticky;
		position:sticky;
		left:0;
		right:0;
		top:0;
		height:0px;
	}
}
	
.ui-btn, label.ui-btn {
    border-width: 0px;
}
.ui-listview>li>a.ui-btn {
	border-width: 0px;
}
.ui-listview>li.ui-last-child>a.ui-btn {
	border-bottom-width: 0px;
}
.ui-controlgroup-horizontal .ui-controlgroup-controls .ui-btn.ui-last-child {
    border-right-width: 0px;
}
.ui-input-search {
    border-width: 0px 0px 1px 0px;
}
.ui-slider-track {
	border-width: 0px;
}
.ui-btn-icon-left:after, .ui-btn-icon-right:after, .ui-btn-icon-top:after, .ui-btn-icon-bottom:after, .ui-btn-icon-notext:after, .iconbg {
	background-color: rgba(0,0,0,0.1);
    -webkit-border-radius: 5px;
    border-radius: 5px;
}

.appbarbg{
	background-color: #7FB3D3 !important;}
	
.horizontal {
	display:-webkit-box;
	display:-ms-flexbox;
	display : flex;
	align-items: center;
}
.horizontal .vcenter{
	align-self: stretch;
}
.leftright {
	justify-content: space-between;
}

.flex-center {
	display:flex;flex-wrap:nowrap;width:100%;justify-content: center;
}
.flex-list {
	display:flex;justify-content: space-between;align-items: center;width:100%;
}
.flex-leftright {
	display:flex;width:100%;justify-content: space-between;align-items: center;
}
.flex-right {
	display:flex;width:100%;justify-content: right;
}

.popupbox_auto {
	position:relative;
}
	
@media (max-width: 400px) {
	.hidden_auto_400 {
		display: none;
	}
	.button_horizontal_width {
	}
}
@media (min-width: 400px) {
	.hidden_auto_400 {
	}
}

@media (max-width: 800px) {
	.horizontal_auto div {
		padding-bottom:4px;
	}
	.hidden_auto {
		display: none;
	}
	.popupbox_auto {
		padding: 15px;
	}
	.button_horizontal_width {
		min-width: 50px;
	}
}
@media (min-width: 800px) {
	.horizontal_auto {
		display : flex;
		align-items: stretch;
	}
	.horizontal_auto div {
		flex-grow:1;
	}
	.hidden_auto {
	}
	.popupbox_auto {
		padding: 30px;
	}
	.button_horizontal_width {
		min-width: 80px;
	}
}

.ui-controlgroup, fieldset.ui-controlgroup {
    padding: 0;
    margin: 0;
}

.ui-slider-track .ui-btn.ui-slider-handle {
	border-radius: 5px;
	border-width: 1px;
}
.ui-slider-track {
	height: 6px;
}
.ui-slider-switch {
	border-radius: 5px !important;
	font-weight: normal !important;
}
	
body {
	font-family: -apple-system, "Segoe UI", "Helvetica Neue", "Hiragino Kaku Gothic ProN", メイリオ, meiryo, sans-serif;
	//-webkit-transform: translate3d(0,0,0);
	//-moz-transform: translate3d(0,0,0);
	//-ms-transform: translate3d(0,0,0);
	//-o-transform: translate3d(0,0,0);
	//transform: translate3d(0,0,0);
	margin:0px;
	padding:0px;
	text-shadow: 0px 0px 0px rgba(0,0,0,0) !important;
	
		
}
body, input, select, textarea, button, .ui-btn {
	font-family: -apple-system, "Segoe UI", "Helvetica Neue", "Hiragino Kaku Gothic ProN", メイリオ, meiryo, sans-serif;
}
html {
	-ms-touch-action: manipulation;
	touch-action: manipulation;
}
form{
	padding : 0px;
	margin : 0px;
}
input, textarea {
	-webkit-user-select : auto;
	#color: black;
}

a:link {text-decoration : none;}
a:visited {text-decoration : none;}
a:hover {text-decoration : underline;}
a:active {text-decoration : none;}

.defbg{
	background-color: white;
}
.menubar { 
	padding-top:10px;
	padding-left:10px;
	padding-bottom:5px;
	padding-right:5px;
	font-size:130%;
	border-top:0px solid #666666;
	border-left:0px solid #666666;
	color:#666666;
	font-weight:bold;
	margin-top:1px; 
}
.ui-mini { margin:0px; }

.que{
	display:none;
	padding-top:5px;
	padding-bottom:10px;
	//text-align:left;
	color:gray;
}
.que_but{
	opacity:0.7;width:25px;
	cursor:pointer;
}

.defborder{
	border-color:rgb(204, 214, 221);
}

.smfullborderbox{
	border-width:1px;
	border-style:solid;
	margin-left:10px;
	margin-right:10px;
	border-radius:6px;
	overflow:hidden;
}

.buttonborder, .autofullbutton {
	border-width: 1px;
	border-style: solid;
	border-color:rgba(204, 214, 221, 0.5);
	border-radius: 4px;
	overflow: hidden;
	box-shadow: 0 0 1px rgba(0,0,0,.05);
}
.buttonborder a {
	line-height: 20px;
}

.buttonborder .ui-select, .buttonborder .ui-radio, .buttonborder .ui-checkbox {
	margin:0;
	padding:0;
}
.buttonborder div.ui-btn {
	margin:0;
}

.undertextbox div {
	border:0px;
	border-bottom:1px solid;
}

.dataarea { 
	padding:10px;margin-bottom:10px;
}


#slide_menu{
	position:fixed;
	top: 0px;
			left: -300px;
		width: 300px;
		height: 100%;
	background: #CCD6DD;
	max-width:80%;
	overflow-x:hidden;
	z-index:9999999;
}
.layer{
    position: fixed;
    top: 0;
    z-index: 1;
    display: none;
    width: 100%;
    height: 100%;
    background-color: transparent;
}
#area-master{
	position: relative;
	top:0 ;
	left:0 ;
	width: 100%;

			background-color: white;
		background-image:url(img/overbg.png?v=1);
		background-size:240px 240px;
		background-repeat:no-repeat;
		background-position:-50px -50px;
	}
.font_gray {
	color: #666666;
}

.buttonbg{
	background-color: #F5F8FA !important;
}

#fullfooter{
	margin-top:50px;
	background-color:rgba(128,128,128,0.03);
	padding:0px;
	border-top:1px solid rgba(128,128,128,0.1);
	text-align:center;
	flex-grow:1;
}

@media (prefers-color-scheme: light) {

		.ui-page-theme-a .ui-btn, html .ui-bar-a .ui-btn, html .ui-body-a .ui-btn, html body .ui-group-theme-a .ui-btn, html head + body .ui-btn.ui-btn-a, .ui-page-theme-a .ui-btn:visited, html .ui-bar-a .ui-btn:visited, html .ui-body-a .ui-btn:visited, html body .ui-group-theme-a .ui-btn:visited, html head + body .ui-btn.ui-btn-a:visited, .buttonbg{
			background-color: #F5F8FA;			border-color: #CCD6DD;		}
		.ui-page-theme-a .ui-btn:hover, html .ui-bar-a .ui-btn:hover, html .ui-body-a .ui-btn:hover, html body .ui-group-theme-a .ui-btn:hover, html head + body .ui-btn.ui-btn-a:hover{
			background-color: #ebf4fa !important;			border-color: #ebf4fa !important;		}
		.ui-body-a, .ui-page-theme-a .ui-body-inherit, html .ui-bar-a .ui-body-inherit, html .ui-body-a .ui-body-inherit, html body .ui-group-theme-a .ui-body-inherit, html .ui-panel-page-container-a{
			border-color: #CCD6DD;		}
		.ui-bar-a, .ui-page-theme-a .ui-bar-inherit, html .ui-bar-a .ui-bar-inherit, html .ui-body-a .ui-bar-inherit, html body .ui-group-theme-a .ui-bar-inherit{
			background-color: #F5F8FA !important;			border-color: #CCD6DD !important;		}
		.ui-link{
					}
		.ui-page-theme-a .ui-btn.ui-btn-active,html .ui-bar-a .ui-btn.ui-btn-active,html .ui-body-a .ui-btn.ui-btn-active,html body .ui-group-theme-a .ui-btn.ui-btn-active,html head + body .ui-btn.ui-btn-a.ui-btn-active,.ui-page-theme-a .ui-checkbox-on:after,html .ui-bar-a .ui-checkbox-on:after,html .ui-body-a .ui-checkbox-on:after,html body .ui-group-theme-a .ui-checkbox-on:after,.ui-btn.ui-checkbox-on.ui-btn-a:after,.ui-page-theme-a .ui-flipswitch-active,html .ui-bar-a .ui-flipswitch-active,html .ui-body-a .ui-flipswitch-active,html body .ui-group-theme-a .ui-flipswitch-active,html body .ui-flipswitch.ui-bar-a.ui-flipswitch-active,.ui-page-theme-a .ui-slider-track .ui-btn-active,html .ui-bar-a .ui-slider-track .ui-btn-active,html .ui-body-a .ui-slider-track .ui-btn-active,html body .ui-group-theme-a .ui-slider-track .ui-btn-active,html body div.ui-slider-track.ui-body-a .ui-btn-active{
					}
		.menubar { 
											}
		.deffont{
					}
		.defborder{
			border-color: #CCD6DD !important;		}
		.defbg{
			background-color: #F5F8FA !important;		}

		.popborder{
			border-color: #DAE5EC !important;		}
		.popbg{
			background-color: #DAE5EC !important;		}
		.appbarbg{
			background-color: #7FB3D3 !important;		}
		.detailbox{
			border-color: #CCD6DD !important;		}
		
		.fade_bg{
			background-color:rgba(128,128,128,0.1);
		}
		
		.biginput{
			color: black;
		}
		
}

.detailbox{
	display: none;
	padding: 15px;
	border-style: solid;
	border-top-width: 0px;
	border-bottom-width: 1px;
	border-left-width: 1px;
	border-right-width: 1px;
}

.noticebox{
	padding:10px;
	border:1px solid #fbd551;
	background-color:#fef2c9;
	//text-align:left;
	margin-bottom:6px;
	color:#4d4d4d;
	border-radius:4px;
}
.noticebox_red{
	border:1px solid #E40023;
	background-color:#FFAEB0;
	border-radius:4px;
}
.titlebox{
	padding:6px;
	padding-left:10px;
	text-align:left;
	border-width:1px;
	border-style:solid;
	border-color:rgba(0,0,0,0.3);
	border-radius:5px;
}
.valuebox{
	padding:6px;
	padding-left:10px;
	text-align:left;
	border-width:1px;
	border-style:solid;
	border-color:rgba(0,0,0,0.1);
	border-radius:5px;
	background-color: rgba(128,128,128,0.02);
}
.whitebox{
	padding-top:6px;
	padding-bottom:6px;
}
.biginput{
	border-width:1px;
	border-style:solid;
	border-radius:6px;
	padding:10px;
	width:100%;
	background-color: rgba(255,255,255,0.2);
}
.bigsearch{
	background-color: rgba(255,255,255,0.2);
	border-width:1px;
	border-style:solid;
	border-radius:6px;
	padding:10px;
	width:100%;
	font-size:90%;
	padding-left:40px;
	background-repeat:no-repeat;
	background-position:7px center;
	background-size:25px;
	background-image:url(img/icon_search.png?v=1);
}
.ui-input-search{
	background-color: rgba(255,255,255,0.2);
	border-width:1px;
	border-style:solid;
	border-radius:6px;
}
.ui-input-search input {
	background-color: rgba(0,0,0,0);
	padding:10px;
	width:100%;
	font-size:90%;
	padding-left:40px;
	background-repeat:no-repeat;
	background-position:7px center;
	background-size:25px;
	background-image:url(img/icon_search.png?v=1);
}
.ui-input-search:after {
	background-image:url("");
}

.force_left{
			text-align:left !important;
		margin: 0px;
}
.force_right{
			text-align:right !important;
		margin: 0px;
}
.force_center{
	text-align:center !important;
	margin: 0px;
}

.autofullbutton {

		margin:10px;
		border-size:1px;
		border-style:solid;
		border-radius:6px;

}

.loader {
	background-image: url(img/loader_icon.png);
	background-repeat:no-repeat;
	background-position:center center;
	background-size:60px 60px;
	width: 60px;
	height: 60px;
	margin: auto;
	padding: 30px;
	//display: inline-block;
	//position: relative;
	-webkit-transform: translateZ(0);
	-ms-transform: translateZ(0);
	transform: translateZ(0);
	-webkit-animation: loader_anim 1.1s infinite linear;
	animation: loader_anim 1.1s infinite linear;
	text-indent: -200px;
	overflow: hidden;
	opacity:0.5;
}
	@-webkit-keyframes loader_anim {
		0% {
			-webkit-transform: rotate(0deg);
			transform: rotate(0deg);
		}
		100% {
			-webkit-transform: rotate(360deg);
			transform: rotate(360deg);
		}
	}
	@keyframes loader_anim {
		0% {
			-webkit-transform: rotate(0deg);
			transform: rotate(0deg);
		}
		100% {
			-webkit-transform: rotate(360deg);
			transform: rotate(360deg);
		}
	}

@media (prefers-color-scheme: dark) {	
	.ui-page-theme-a a, html .ui-bar-a a, html .ui-body-a a, html body .ui-group-theme-a a {
		color: #82c8ff;
	}


	#area-master{
		background-image: url();
		background-color: #000000;
	}
	.defbg{
		background-color: #000000;
	}
	
	.ui-body-a, .ui-page-theme-a .ui-body-inherit, html .ui-bar-a .ui-body-inherit, html .ui-body-a .ui-body-inherit, html body .ui-group-theme-a .ui-body-inherit, html .ui-panel-page-container-a{
		background-color: #000000;
		border-color:#333333;
	}
	
	.ui-overlay-a, .ui-page-theme-a, .ui-page-theme-a .ui-panel-wrapper {
		background-color: rgba(0,0,0,0) !important;
		text-shadow: 0px 0px 0px rgba(0,0,0,0) !important;
		color: white;
	}
	.ui-overlay-a {
		background-color: #000000 !important;
	}
	.simplebutton{
		background-color:rgba(0,0,0,0) !important;
		color:white !important;
	}
	.titletext {
		color: white !important;
	}
	.menubar {
		color: white !important;
		border-color:#999999 !important;
	}
	.mastermenuicon {
		border:1px solid white !important;
	}
	.que {
		color: white;
	}
	.deffont {
		color: white !important;
	}
	.font_gray {
		color: rgba(255,255,255,0.8);
	}
	
	.force_light {
		color: #666666 !important;
	}
	.force_light .defbg{
		background-color: white !important;
	}
	.force_light .deffont {
		color: #666666 !important;
	}
	.force_light .que {
		color: #666666 !important;
	}
	.force_light .menubar {
		color: #666666 !important;
	}
	.force_light .deffont {
		color: #666666 !important;
	}
	.force_light .font_gray {
		color: #666666 !important;
	}
	
	.noticebox{
		border:1px solid rgba(51,51,51,0.7);
		background-color:rgba(51,51,51,0.7);
		color:white;
	}
	.titlebox{
		background-color: #333333;
		border-color: rgba(0,0,0,0);
		color: white;
		text-shadow: 0px 0px 0px rgba(0,0,0,0);
	}
	.valuebox{
		background-color: rgba(51,51,51,0.7);
		border-color: rgba(0,0,0,0);
		color: white;
		text-shadow: 0px 0px 0px rgba(0,0,0,0);
	}
    
	.ui-bar-a, .ui-bar-inherit, .ui-btn, .ui-input-text, .ui-input-search, .popborder, .simpleinput, .simpleinput input, .buttonbg {
		background-color: #333333 !important;
		border-color: rgba(0,0,0,0) !important;
		color: white !important;
		text-shadow: 0px 0px 0px rgba(0,0,0,0) !important;
	}
	.ui-page-theme-a .ui-btn:hover, html .ui-bar-a .ui-btn:hover, html .ui-body-a .ui-btn:hover, html body .ui-group-theme-a .ui-btn:hover, html head + body .ui-btn.ui-btn-a:hover{
		background-color: #666666 !important;
	}
	
	.ui-btn-icon-notext:after {
		background-color: rgba(255,255,255,0.2);
	}
    
	.detailbox{
		border-color:rgb(51, 41, 34) !important;
	}

	.defborder{
		border-color:rgb(51, 41, 34) !important;
	}

	#slide_menu, #area-alert-dialog, #area-confirm-dialog, #area-newaddress-view, .popupbox{
		background: #000000;
		text-shadow: 0px 0px 0px rgba(0,0,0,0) !important;
		#border-color:rgb(51, 41, 34) !important;
		color: white;
	}
	
	#area-alert-dialog, #area-confirm-dialog{
		color: #ffffff;
	}
	
	.mailbodybox {
		background-color: rgb(170, 170, 170);
	}
		
	.ui-btn-icon-left:after, .ui-btn-icon-right:after, .ui-btn-icon-top:after, .ui-btn-icon-bottom:after, .ui-btn-icon-notext:after, .iconbg {
		background-color: rgba(255,255,255,0.5);
	}
	
	.appbarbg{
		background-color: black !important;
	}
		
	.buttonborder, .autofullbutton {
		border-color:rgba(255, 255, 255, 0.5);
		box-shadow: 0 0 1px rgba(255,255,255,.05);
	}
	
	.oauth_button_apple{
		background-color:white;
	}
	.oauth_button_apple img{
		filter: invert(100%);
	}
	.oauth_button_google{
		background-color:white;
	}
	.oauth_button_qrcode{
		background-color:white;
	}
	
	.autoicon img{
		filter: invert(100%);
	}
	
	.ui-popup {
	    border-color: rgba(255,255,255,0.6) !important;
	}
	
	.noborderinput{
		background-color: black;
		color: white;
	}
	
	.fade_bg{
		background-color:rgba(255,255,255,0.1);
	}
	
	.biginput{
		color: white;
	}
	
	#fullfooter{
		background-color:rgba(255,255,255,0.1);
		border-top:1px solid rgba(255,255,255,0.3);
	}
	
}	-->
      </style>
      <script type="text/javascript">
       var cookie = {};
cookie.get = function(name) {
    var regexp = new RegExp('; ' + name + '=(.*?);');
    var match  = ('; ' + document.cookie + ';').match(regexp);
    return match ? decodeURIComponent(match[1]) : '';
}
cookie.set = function(name, value) {
    var buf = name + '=' + encodeURIComponent(value);
    document.cookie = buf + '; expires=Mon, 31-Dec-2029 23:59:59 GMT; domain=m.kuku.lu; path=/';
}
cookie.localset = function(name, value) {
    var buf = name + '=' + encodeURIComponent(value);
    document.cookie = buf + '; expires=Mon, 31-Dec-2029 23:59:59 GMT;';
}

function CookieQuery(_query) {
    cookie.set("cookie_next_query", ""+_query);
}

function queView(_tar, _but) {
	_but.style.opacity = "1";
	setTimeout(function(){_but.style.opacity = "0.7"}, 200);
	openAlertDialog(document.getElementById(""+_tar).innerHTML, function(){});
	
}
function toggleView(_tar) {
	if (document.getElementById(""+_tar).style.display == "block") {
		document.getElementById(""+_tar).style.display = "none";
	} else {
		document.getElementById(""+_tar).style.display = "block";
	}
}


function parseValue(_str) {
	var _result = new Array();
	var _str = _str.split(";");
	for (var i in _str) {
		var _epos = _str[i].indexOf("=");
		if (_epos == -1) continue;
		
		var _pre = _str[i].slice(0, _epos);
		var _suf = _str[i].slice(_epos+1);
		if (!_pre) continue;
		
		_suf = ""+_suf.split("#_S_#").join(";");
		_suf = ""+_suf.split("#_E_#").join("=");
		_suf = ""+_suf.split("#_A_#").join("&");
		
		_result[_pre] = ""+_suf;
	}
	return _result;
}
function parseURLParam(_str) {
	var _result = new Array();
	var _str = _str.split("&");
	for (var i in _str) {
		var _epos = _str[i].indexOf("=");
		if (_epos == -1) continue;
		
		var _pre = _str[i].slice(0, _epos);
		var _suf = _str[i].slice(_epos+1);
		if (!_pre) continue;
		
		_suf = ""+_suf.split("#_S_#").join(";");
		_suf = ""+_suf.split("#_E_#").join("=");
		_suf = ""+_suf.split("#_A_#").join("&");
		
		_result[_pre] = ""+_suf;
	}
	return _result;
}

/*
function parseValue( src ) {
	var _result = new Array();
	var _src = src.split(";");
	for (var i = 0; i<_src.length; i++) { 
		var _ent = _src[i].split("=");
		_result[""+_ent[0]] = ""+_ent[1];
	}
	return _result;
}

function parseURLParam( src ) {
	var _result = new Array();
	var _src = src.split("&");
	for (var i = 0; i<_src.length; i++) { 
		var _ent = _src[i].split("=");
		_result[""+_ent[0]] = ""+_ent[1];
	}
	return _result;
}
*/

	var __oldlocationhash = location.hash;
	var __locationhashkey = "p255";
	setInterval(function(){
		if (location.hash != __oldlocationhash) {
			var _hash = location.hash;
			
			if (_hash.indexOf("#"+__locationhashkey) === 0) {
			} else {
				closeAlertDialog();
			}
			__oldlocationhash = _hash;
		}
	}, 50);

var __lastpopupmenu = false;
function openPopupMenu(_target) {
	console.log("openPopupMenu: ", _target);
	closeAlertDialog();
	
	if (!_target) {
		if (__lastpopupmenu) {
			_target = __lastpopupmenu;
		} else {
			return;
		}
	}
	
	if (_target.indexOf("#") == -1 && _target.indexOf(".") == -1) {
		_target = "#"+_target;
	}
	if (_target != "#area-alert-dialog" && _target != "#area-confirm-dialog" && _target != "#area-loading-dialog") {
		__lastpopupmenu = _target;
	}
	
			location.hash = "#"+__locationhashkey;
		
	$(_target).popup("open", {positionTo: "window"});
	$(document).off("focusin");
	$(document).off("focus");
	
	$(_target).css({
		"max-width": "1000px",
		"width": ""+(parseInt($(window).width())*0.90)+"px",
		"margin-left": "auto",
		"margin-right": "auto",
		"margin-top": "15px",
		"margin-bottom": "15px",
	});
		
	$(_target+"-popup").css({
		"width": ""+(parseInt($(window).width()))+"px",
		"max-width": ""+(parseInt($(window).width()))+"px",
		"max-height": ""+(parseInt($(window).height()))+"px",
		"overflow-y": "auto",
	});
	$(_target+"-popup").scrollTop(0);
		
	if (parseInt($(_target+"-popup").css("top")) <= parseInt($(window).scrollTop())) {
		$(_target+"-popup").css("top", $(window).scrollTop()+"px");
	}
	
	$("body").css("overflow-y", "hidden");
	
	$(_target).off("popupafterclose");
	$(_target).on("popupafterclose", function( e, ui ) { closePopupMenu(_target); } );
	
	$(_target+"-popup").off("tap");
	$(_target+"-popup").on("tap", function( e, ui ) {
		console.log("tap:", e.target.id);
		if ("#"+e.target.id == _target+"-popup") {
			closePopupMenu(_target);
			return false;
		}
	});
	
	document.addEventListener('touchmove', handleTouchMove, { passive: false });
	
	if (window.PointerEvent) {
		$(_target+"-popup").off("pointerdown");
		$(_target+"-popup").on("pointerdown", function( e, ui ) {
			console.log("pointerdown:", e.target.id);
			if ("#"+e.target.id == _target+"-popup") {
				closePopupMenu(_target);
				return false;
			}
		});
	} else {
		$(_target+"-popup").off("mousedown");
		$(_target+"-popup").on("mousedown", function( e, ui ) {
			console.log("mousedown:", e.target.id);
			if ("#"+e.target.id == _target+"-popup") {
				closePopupMenu(_target);
				return false;
			}
		});
	}
	
	$(_target).off("popupbeforeposition");
	$(_target).on("popupbeforeposition", function( e, ui ) {
		console.log("popupbeforeposition", ui);
		setTimeout(function(){
			$(_target).css({
				"max-width": "1000px",
				"width": ""+(parseInt($(window).width())*0.90)+"px",
				"margin-left": "auto",
				"margin-right": "auto",
				"margin-top": "15px",
				"margin-bottom": "15px",
			});
			
			$(_target+"-popup").css({
				"width": ""+(parseInt($(window).width()))+"px",
				"max-width": ""+(parseInt($(window).width()))+"px",
				"max-height": ""+(parseInt($(window).height()))+"px",
				"overflow-y": "auto",
			});
				
			$("body").css("overflow-y", "hidden");
			
			if (parseInt($(_target+"-popup").css("top")) <= parseInt($(window).scrollTop())) {
				$(_target+"-popup").css("top", ""+$(window).scrollTop()+"px");
			}
		}, 10);
	} );
}

	function handleTouchMove(e) {
		console.log("handleTouchMove: e.target.id: "+e.target.id);
		
		if (__lastpopupmenu+"-screen" == "#"+e.target.id) {
			e.preventDefault();
		}
	}

function closePopupMenu(_target) {
	console.log("closePopupMenu: ", _target);
	
	$("#area-alert-dialog").popup("close");
	$("#area-confirm-dialog").popup("close");
	$("#area-loading-dialog").popup("close");
	
	if (!_target) {
		if (__lastpopupmenu) {
			_target = __lastpopupmenu;
		} else {
			return;
		}
	}
	if (_target.indexOf("#") == -1 && _target.indexOf(".") == -1) {
		_target = "#"+_target;
	}
	
	if (!_target) {
		return;
	}
	
	document.removeEventListener('touchmove', handleTouchMove, { passive: false });
	
	$(_target).off("popupafterclose");
	$("body").css("overflow-y", "auto");
		
	$(_target).popup("close");
}
function resizePopupMenu() {
	if (!__lastpopupmenu) return;
	_target = __lastpopupmenu;
	closePopupMenu(_target);
	openPopupMenu(_target)
}

function viewClickButton(_tar) {
	if (_tar.style) {
		_tar.style.opacity = 0.7;
		setTimeout(function(){_tar.style.opacity = 1;}, 200);
	} else {
		$(_tar).css("opacity", 0.7);
		setTimeout(function(){$(_tar).css("opacity", 1);}, 200);
	}
}


function safeString(_str) {
	if (!_str || _str == undefined || _str == null) return "";
	return _str;
}

function safestr(_str) {
	return _str.split("<").join("&lt;").split(">").join("&gt;");
}

function viewAddr(_addr) {
	if (!_addr) return "";
	
	if (_addr.length >= 40) {
		var _tmp = _addr.split("@");
		if (_tmp[0].length >= 20) {
			_tmp[0] = _tmp[0].slice(0, 20)+"..";
		}
		if (_tmp[1]) {
			if (_tmp[1].length >= 20) {
				_tmp[1] = ".."+_tmp[1].slice(_tmp[1].length - 20);
			}
			_addr = _tmp[0]+"@"+_tmp[1];
		} else {
			_addr = _tmp[0];
		}
	}
	return _addr;
}


	function editAlias(_address) {
		viewLoading();

		$.ajax({
		    url: "aliaslist.php",
		    type: "GET",
		    data: "&action=dialog&mode=alert_dialog&ajax=1&address="+encodeURIComponent(_address),
		    timeout: 10000,
		    cache: false
		}).done(function(data, status, xhr) {
			if (data.indexOf("#OK#") != -1) {
				openAlertDialog(""+data+"");
			}
		}).fail(function(xhr, status, error) {
		    viewError("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。");
		});
	}

	function viewLoading() {
		closePopupMenu();
		closeAlertDialog();
			
		$("#area-loading-dialog").popup("close");
		
		$("#area-loading-dialog-loading").css("display", "none");
		$("#area-loading-dialog").popup("open");
		$("#area-loading-dialog").removeClass("ui-popup ui-body-inherit ui-overlay-shadow ui-corner-all");
		setTimeout(function(){
			$("#area-loading-dialog-loading").css("display", "block");
		}, 200);
	}

function formPost(action, data, target) {
	var form = document.createElement("form");
	form.setAttribute("target", target);
	form.setAttribute("action", action);
	form.setAttribute("method", "post");
	form.style.display = "none";
	document.body.appendChild(form);
	if (data !== undefined) {
		for (var paramName in data) {
			var input = document.createElement('input');
			input.setAttribute('type', 'hidden');
			input.setAttribute('name', paramName);
			input.setAttribute('value', data[paramName]);
			form.appendChild(input);
		}
	}
	form.submit();
}

function viewQRCode(_addr, _callback) {
	var _data = '<center><h3>'+decodeURIComponent(_addr)+'</h3>';
	_data += '<img src="https://qrcode.kuku.lu/?service=mailnow&data='+encodeURIComponent(_addr)+'&s=5" width="180" height="180" style="border-radius: 6px;"></center>';
	
	if (_callback) {
		openAlertDialog(_data, _callback);
	} else {
		openAlertDialog(_data, function(){});
	}
	
}

function editFilter(_type, _value) {
	var _cookie_name = "cookie_filter_recv2";
		
	var _cookie = cookie.get(_cookie_name);
	var _json = {};
	if (_cookie) {
		try {
			_json = JSON.parse(_cookie);
		} catch(e) {
		}
	}
	_json[_type] = _value;
	cookie.set(_cookie_name, ""+JSON.stringify(_json));
	
	//cookie.set("cookie_"+_type, ""+_value);
	//query_data[""+_type] = ""+_value;
	viewMail("&"+GetQuery("action,page"));
}

function clearFilter() {
	FlexCall("action=clearFilter;"); //過去アプリ互換用
		
	var _cookie_name = "cookie_filter_recv2";
		cookie.set(_cookie_name, "");
	
	cookie.set("cookie_filter_mailaddr", "");
	cookie.set("cookie_filter_mailtype", "");
	cookie.set("cookie_filter_mailfilter", "");
	
	query_data["filter_mailaddr"] = "";
	query_data["filter_mailtype"] = "";
	query_data["filter_mailfilter"] = "";
	
	viewMail("&"+GetQuery("action,page"));
}

function updateFilterComplete(_update) {
	/*
	setTimeout(function(){
		cookie.set("cookie_filter_mailaddr", "");
		cookie.set("cookie_filter_mailtype", "");
		cookie.set("cookie_filter_mailfilter", "");
		
		query_data["filter_mailaddr"] = "";
		query_data["filter_mailtype"] = "";
		query_data["filter_mailfilter"] = "";
		
		_update = parseURLParam(_update);
		for (var i in _update) {
			query_data[""+i] = ""+decodeURIComponent(_update[i]);
			cookie.set("cookie_"+i, ""+decodeURIComponent(_update[i]));
		}
		//debug = true;
		enable_filter = false;
		viewMail("&"+GetQuery("action,page"));
	}, 10);
	*/
}

function openMailAddrData(_addr) {
	closePopupMenu();
	viewLoading();
	
	$.ajax({
	    url: "index._addrlist_addr.php",
	    type: "GET",
	    data: "&address="+encodeURIComponent(_addr)+"&t="+(new Date()).getTime()+"&nopost=1",
	    timeout: 20000,
	    cache: false
	}).done(function(data, status, xhr) {
		closeAlertDialog();
		if (data.indexOf("[OK]") != -1) {
			$("#area_addrdata").html(data).trigger( "create" );
			$("#area_addrdata").css("display", "block");
			openPopupMenu("#area_addrdata");
		}
	}).fail(function(xhr, status, error) {
		
	});
}

	function openMailAddrMailer(_addr) {
		closePopupMenu();
		
		$.ajax({
		    url: "smphone.app.index._addrlist_maileraccount.php",
		    type: "GET",
		    data: "&address="+encodeURIComponent(_addr)+"&t="+(new Date()).getTime()+"&nopost=1",
		    timeout: 20000,
		    cache: false
		}).done(function(data, status, xhr) {
			closeAlertDialog();
			if (data.indexOf("[OK]") != -1) {
				$("#area_addrdata").html(data).trigger( "create" );
				$("#area_addrdata").css("display", "block");
				openPopupMenu("#area_addrdata");
			}
		}).fail(function(xhr, status, error) {
			
		});
	}

//更新でなくタブ切り替えのみの場合に発火
var tabRefreshQueues = [];
function tabRefreshQueue(_func) {
	tabRefreshQueues.push(_func);
}
function tabRefresh() {
	if (tabRefreshQueues.length <= 0) return;
	for (var i in tabRefreshQueues) {
		tabRefreshQueues[i]();
	}
}
var block_tabrefresh = false;
function blockTabrefresh() {
	block_tabrefresh = true;
}


function scrollToY(_posy) {
    if ('scrollingElement' in document) {
        document.scrollingElement.scrollTop = _posy;
    } else {
        document.body.scrollTop = _posy;
    }
}window.scrollTo = function(){return false;};
      </script>
     </link>
    </meta>
   </meta>
  </meta>
 </head>
 <body style="display:flex;flex-flow:column;min-height:100vh;">
  <style>
   .ui-page{
        flex-flow:column;
        display:flex !important;
    }
  </style>
  <!-- WebPush -->
  <script>
   if(navigator.userAgent.match(/Firefox\/(\d+)/) && window.PushManager && !PushManager.supportedContentEncodings) {
	  PushManager.supportedContentEncodings = (parseInt(RegExp.$1) >= 55) ? ['aes128gcm', 'aesgcm'] : ['aesgcm'];
	}
	console.log(PushManager.supportedContentEncodings);
	var subscription = null;
	var authType = 'vapid';
	var serverKey = urlBase64ToUint8Array('BDx99jpA8VccxBYUnG-qgdivL9b_6zb4R9QrH5J9EkiwK58ikysouwrlmqggTRJt5h0jaPKq6g4TBuyjIEwJhsg');
	function encodeBase64URL(buffer) {
	  return btoa(String.fromCharCode.apply(null, new Uint8Array(buffer))).replace(/\+/g, '-').replace(/\//g, '_').replace(/=+$/, '');
	}
	function arrayBufferToBase64(arrayBuffer) {
	    return window.btoa(String.fromCharCode.apply(null, new Uint8Array(arrayBuffer))).replace(/\+/g, '-').replace(/\//g, '_');
	}

	function decodeBase64URL(str) {
	  let dec = atob(str.replace(/\-/g, '+').replace(/_/g, '/'));
	  let buffer = new Uint8Array(dec.length);
	  for(let i = 0 ; i < dec.length ; i++)
	    buffer[i] = dec.charCodeAt(i);
	  return buffer;
	}

	function urlBase64ToUint8Array(base64String) {
	  const padding = '='.repeat((4 - base64String.length % 4) % 4);
	  const base64 = (base64String + padding)
	    .replace(/\-/g, '+')
	    .replace(/_/g, '/');

	  const rawData = window.atob(base64);
	  const outputArray = new Uint8Array(rawData.length);

	  for (let i = 0; i < rawData.length; ++i) {
	    outputArray[i] = rawData.charCodeAt(i);
	  }
	  return outputArray;
	}

		
	function togglePushSubscription() {
		requestNotificationPermission();
	}
	function requestNotificationPermission() {
	  Notification.requestPermission(function(permission) {
	    if(permission !== 'denied') {
	      requestPushPermission();
	    }
	  });
	}
	function requestPushPermission() {
	  if('permissions' in navigator) 
	    navigator.permissions.query({
	      name: 'push',
	      userVisibleOnly: true
	    }).then(checkPushPermission);
	  else if(Notification.permission !== 'denied') {
	    navigator.serviceWorker.ready.then(requestPushSubscription);
	  }
	}
		function checkPushPermission(evt) {
		  let state = evt.state || evt.status;
		  if(state !== 'denied')
		    navigator.serviceWorker.ready.then(requestPushSubscription);
		}
	function requestPushSubscription(registration) {
		console.log("requestPushSubscription()");
			
		let opt = {
			userVisibleOnly: true,
			applicationServerKey: serverKey
		};
		return registration.pushManager.subscribe(opt).then(getSubscription, errorSubscription);
	}
		function errorSubscription(err) {
			console.error(err);
		}
	function serviceWorkerReady(registration) {
		console.log("serviceWorkerReady()");
		if('pushManager' in registration) {
			registration.pushManager.getSubscription().then(getSubscription);
		} else {
		}
	}
	function getSubscription(sub) {
			console.log("getSubscription()");
			//console.log(sub);
			if(sub) {
				enablePushRequest(sub);
			} else {
				togglePushSubscription();
			}
	}
	function enablePushRequest(sub) {
		var key = null;
		var auth = null;
		
		subscription = sub;

		console.log("endpoint: "+sub.endpoint);
		if('getKey' in sub) {
			try {
				key = encodeBase64URL(sub.getKey('p256dh'));
				auth = encodeBase64URL(sub.getKey('auth'));
				
				console.log("key: "+key);
				console.log("auth: "+auth);
			} catch(e) {
				console.error(e);
			}
		}

		if ('supportedContentEncodings' in PushManager) {
		  contentEncoding = PushManager.supportedContentEncodings.includes('aes128gcm') ? 'aes128gcm' : 'aesgcm';
		} else {
		  contentEncoding = 'aesgcm';
		}

		console.log("contentEncoding: "+contentEncoding);

		$.ajax({
		    url:'_push_server.php?action=registWebPushToken&lang=ja&platform=WebPush&endpoint='+encodeURIComponent(sub.endpoint)+'&key='+encodeURIComponent(key)+'&auth='+encodeURIComponent(auth)+'&contentEncoding='+encodeURIComponent(contentEncoding)+'&t='+Math.floor(Math.random()*100),
		    type:'GET',
		    data:""
		}).done(function(data){
			console.log(data);
			
			localStorage.setItem('webpush_token', key);
			cookie.set("webpush_token", "key="+encodeURIComponent(key)+";");
		}).fail(function(){
		});
		
		$("#pushsys_token_notfound").css("display", "none");
		$("#pushsys_token_found").css("display", "block");

	}
	
	function requestPushUnsubcription() {
		if(subscription) {
			$.ajax({
			    url:'_push_server.php?action=deleteWebPushToken&platform=WebPush&endpoint='+encodeURIComponent(subscription.endpoint)+'&t='+Math.floor(Math.random()*100),
			    type:'GET',
			    data:""
			}).done(function(data){
				console.log(data);
			}).fail(function(){
			});
			
			subscription.unsubscribe();
			subscription = null;
			
			localStorage.setItem('webpush_token', "");
			cookie.set("webpush_token", "");

			$("#pushsys_token_found").css("display", "none");
			$("#pushsys_token_notfound").css("display", "block");
		}
	}

	function initPush() {
		console.log("initPush()");
		if('serviceWorker' in navigator) {
			console.log("serverKey: "+serverKey);
			navigator.serviceWorker.ready.then(serviceWorkerReady);
			navigator.serviceWorker.register('webpush_worker.js?t=1752622386');
			navigator.serviceWorker.getRegistration()
				.then(function(registration) { return registration.update(); })
				.then(function() {
				})
				.catch(function(e) {
			});
		}
	}

	setTimeout(function(){
		var webpush_token = localStorage.getItem('webpush_token');
		if (webpush_token) {
			initPush();
		} else {
			$("#pushsys_token_notfound").css("display", "block");
		}
	}, 100);
  </script>
  <!-- --------------------------------------------- -->
  <script>
   function toggleMenu() {
			if ($(".layer").css("display") == "none") {
				openMenu();
			} else {
				closeMenu();
			}
		}
	    function openMenu(){
	    	$(".layer").show();
			$("#area-master").animate({'left' : 300 }, 300);
			$("#slide_menu").animate({'left' : 0 }, 300);
		}
	    function closeMenu(){
	    	$(".layer").hide();
			$("#area-master").animate({'left' : 0 }, 300);
			$("#slide_menu").animate({'left' : -300 }, 300);
		}
  </script>
  <div class="layer" onclick="closeMenu();">
  </div>
  <nav class="defbg" id="slide_menu">
   <div class="defborder" style="padding-right:10px;border-right-width:2px;border-right-style:solid;height:100%;">
    <br/>
    <a data-icon="bullets" data-iconpos="right" data-role="button" data-shadow="false" href="addrsort.php">
     アドレスの並び替え
    </a>
    <a data-icon="delete" data-iconpos="right" data-role="button" data-shadow="false" href="addrdelete.php">
     アドレスの一括削除
    </a>
    <a data-icon="recycle" data-iconpos="right" data-role="button" data-shadow="false" href="addrreserve.php">
     削除済みアドレス
    </a>
    <a data-icon="edit" data-iconpos="right" data-role="button" data-shadow="false" href="aliaslist.php">
     アドレスの別名
    </a>
    <a data-icon="phone" data-iconpos="right" data-role="button" data-shadow="false" href="mailformgen.php">
     メールフォーム
    </a>
    <a data-icon="alert" data-iconpos="right" data-role="button" data-shadow="false" href="denylist.php">
     受信拒否
    </a>
    <a data-icon="user" data-iconpos="right" data-role="button" data-shadow="false" href="addrtransfer.php">
     アドレスの譲渡
    </a>
    <br/>
    <a data-icon="gear" data-iconpos="right" data-role="button" data-shadow="false" href="config.php">
     詳細設定
    </a>
    <a data-icon="power" data-iconpos="right" data-role="button" data-shadow="false" href="index.php?pagemode_login=1&amp;noindex=1">
     アカウント
    </a>
   </div>
  </nav>
  <style>
   body{padding:0px;margin:0px;}
		.area_gheader_font {
			font-family: 'Meiryo UI',Meiryo,'ＭＳ Ｐゴシック',sans-serif;
			font-size : 12px;
		}
		.area_gheader_site {
			width: 82px;
			text-overflow:ellipsis;
			white-space: nowrap;
			margin-right:2px;
			height: 28px;
			display:flex;
			justify-content: center;
			align-items: center;
		}
			.area_gheader_site > div {
			}
			
		.area_gheader_font a:link {
			text-decoration : none;
		}
		.area_gheader_font a:visited {
			text-decoration : none;
		}
		.area_gheader_font a:hover {
			text-decoration : underline;
		}
		.area_gheader_font a:active {
			text-decoration : none;
		}
		
		.gheader_flex-center {
			display:flex;flex-wrap:nowrap;width:100%;justify-content: center;align-items: center;
		}
		.gheader_flex-list {
			display:flex;justify-content: space-between;align-items: center;width:100%;
		}
		.gheader_flex-leftright {
			display:flex;width:100%;justify-content: space-between;align-items: center;
		}
		.gheader_flex-left {
			display:flex;justify-content: left;align-items: center;width:100%;
		}
		.gheader_flex-right {
			display:flex;width:100%;justify-content: right;align-items: center;
		}
		
		@media screen and (max-width:1100px){
			.area_gheader_autohide_1100p {
				display:none;
			}
		}
		
		@media screen and (max-width:300px){
			.area_gheader_autohide_300p {
				display:none;
			}
		}
  </style>
  <div class="area_gheader_font area_gheader_autohide_300p" style="background-color:#ffffff;border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:#cccccc;">
   <div class="gheader_flex-leftright">
    <div class="gheader_flex-left">
     <style>
      @media screen and (max-width:137px){
								.area_gheader_autohide_137p {
									display:none;
								}
							}
     </style>
     <div class="area_gheader_site area_gheader_autohide_137p" style="background-color:#eeeeee;border-top-width : 2px;border-top-style : solid;border-top-color : #eeeeee;">
      <div>
       <a href="https://m.kuku.lu/" style="color:#bd484b;">
        捨てメアド
       </a>
      </div>
     </div>
     <style>
      @media screen and (max-width:221px){
								.area_gheader_autohide_221p {
									display:none;
								}
							}
     </style>
     <div class="area_gheader_site area_gheader_autohide_221p" style="border-top-width : 2px;border-top-style : solid;border-top-color : #eeeeee;">
      <div>
       <a href="https://draw.kuku.lu/" style="color:#3765ce;">
        絵チャ
       </a>
      </div>
     </div>
     <style>
      @media screen and (max-width:305px){
								.area_gheader_autohide_305p {
									display:none;
								}
							}
     </style>
     <div class="area_gheader_site area_gheader_autohide_305p" style="border-top-width : 2px;border-top-style : solid;border-top-color : #eeeeee;">
      <div>
       <a href="https://live.erinn.biz/" style="color:#3765ce;">
        LIVE配信
       </a>
      </div>
     </div>
     <style>
      @media screen and (max-width:389px){
								.area_gheader_autohide_389p {
									display:none;
								}
							}
     </style>
     <div class="area_gheader_site area_gheader_autohide_389p" style="border-top-width : 2px;border-top-style : solid;border-top-color : #eeeeee;">
      <div>
       <a href="https://d.kuku.lu/" style="color:#3765ce;">
        ファイル転送
       </a>
      </div>
     </div>
     <style>
      @media screen and (max-width:473px){
								.area_gheader_autohide_473p {
									display:none;
								}
							}
     </style>
     <div class="area_gheader_site area_gheader_autohide_473p" style="border-top-width : 2px;border-top-style : solid;border-top-color : #eeeeee;">
      <div>
       <a href="https://c.kuku.lu/" style="color:#3765ce;">
        チャット
       </a>
      </div>
     </div>
     <style>
      @media screen and (max-width:557px){
								.area_gheader_autohide_557p {
									display:none;
								}
							}
     </style>
     <div class="area_gheader_site area_gheader_autohide_557p" style="border-top-width : 2px;border-top-style : solid;border-top-color : #eeeeee;">
      <div>
       <a href="https://s.kuku.lu/" style="color:#3765ce;">
        画像共有
       </a>
      </div>
     </div>
     <style>
      @media screen and (max-width:641px){
								.area_gheader_autohide_641p {
									display:none;
								}
							}
     </style>
     <div class="area_gheader_site area_gheader_autohide_641p" style="border-top-width : 2px;border-top-style : solid;border-top-color : #eeeeee;">
      <div>
       <a href="https://v.kuku.lu/" style="color:#3765ce;">
        動画共有
       </a>
      </div>
     </div>
     <style>
      @media screen and (max-width:725px){
								.area_gheader_autohide_725p {
									display:none;
								}
							}
     </style>
     <div class="area_gheader_site area_gheader_autohide_725p" style="border-top-width : 2px;border-top-style : solid;border-top-color : #eeeeee;">
      <div>
       <a href="https://ddns.kuku.lu/" style="color:#3765ce;">
        DDNS
       </a>
      </div>
     </div>
     <style>
      @media screen and (max-width:809px){
								.area_gheader_autohide_809p {
									display:none;
								}
							}
     </style>
     <div class="area_gheader_site area_gheader_autohide_809p" style="border-top-width : 2px;border-top-style : solid;border-top-color : #eeeeee;">
      <div>
       <a href="https://i.kuku.lu/" style="color:#3765ce;">
        画像変換
       </a>
      </div>
     </div>
     <style>
      @media screen and (max-width:893px){
								.area_gheader_autohide_893p {
									display:none;
								}
							}
     </style>
     <div class="area_gheader_site area_gheader_autohide_893p" style="border-top-width : 2px;border-top-style : solid;border-top-color : #eeeeee;">
      <div>
       <a href="https://magical.kuku.lu/" style="color:#3765ce;">
        お知らせ
       </a>
      </div>
     </div>
    </div>
    <div class="gheader_flex-right" style="margin-right:5px;">
     <div class="area_gheader_autohide_1100p" style="margin-right:10px;text-align : right;">
      <span>
       <a href="javascript:goShortURL_Header();" style="color:#666666;">
        URL短縮
       </a>
      </span>
      |
      <span>
       <a href="https://magical.kuku.lu/page.contact.php" style="color:#666666;" target="_blank">
        お問い合わせ
       </a>
      </span>
      |
      <span>
       <a href="https://status.aquapal.net/" style="color:#666666;" target="_blank">
        稼働状況
       </a>
      </span>
     </div>
     <div>
      <a href="https://aquapal.net/">
       <img border="0" height="17" src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGQAAABkCAYAAABw4pVUAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABnBJREFUeNrsXE1u6zYQZgwfwIsCXcY+QZQTxFl38fxOEGldFIlPkOQEtlF0bb8TxFl0beUEUU9gZVmgC/cELScdta5CDkmRlJRkPoBIANsUOR/nh9QMhWAwGAwGg8FgMBgMBoPBYDAYDAaDwWAwGAwGg6HCSYhOpj/9msg/0MayXRBffZKtkC3Pf/7h0Feh/PHj91OYlmxnso00X4N5vMBcvvvl96JzQiQJM/nni2wzYtAUctm+SWI2gYQIC2Kh+XhuEpr8fXo0H1fA4trKtvIl58SRBBD8jWxXqA0hUILAJDHbAKt6p/n4UgoqV/ymms91w0WlW2j3qufZYOBAxp38s5ftNiAZAvt6kP2vPfs5OBKYHs1nFHA+rwtD9v+AhIfVEPQPa/QRsQHqftnUv0gB/GXSEBTSAwouNmAeX120ZWAgAwb93BIZAp+zjtU5+pnnBmQUaIpc/cMItSUNoiHoM/YWKg0DfcRBl3KFl7V+xihsiMBSi/7uZR93ITUEV+vO0jxtMCKECKpUPGeMpF44BDWZ7GsTwmSlmlV7wIGv6gRY9HljYbsnrv0ShMwtngfzWcm2lII7ODzTJTAwknJiKcB9zZHfw8B99hLom6gVu5H9Z4EIMWGLwjp4mMMRLtyZgfRLKjS2JaTSEugok4IKshGyIMVJSxoSYmVKHMZwh9pIBi468q3CXty8ARHnocjAfgvUNh2uGzjfzsgAyP6AkMwQuNxEPToJoCl7zd4GAoSJw+rcOURQwcmojWVBCR60XxUwDEQ/oNOSMZq10JjHJAM1ZY5Rpw63Xjv1yNgadr4hAaHssqV5ZcQJQorhc/8IwWhNt5rOAu+cs7bmhSZp5eIj+6IhlEMeB3zGSmW3I2NJaUmfCXkhopKQwmkVGN7q/NVImq3Ze9OQUCexG5+Nnye+EZ9d9JWQ2Hjs6sG4My9tgpZ3QQgecno5cymUbcfT0D0/OX5vMuxQyC7hbGKI6UPv4GPgidgo/ju/YUSBj/FBifgvWSARYd/OuQij8+jeZsENA5uVKvFh2pHgewsIKKRpOmjkEs5k4Ulw02yNz4ZCc/Jw6k0IJj2EzD75zBg3JgTzsRZMRCMYTwmGDkSMkIjUNwStRT3w/5+otukHJ+QlCCFIxs7xGKM6MPxNaJIfFGFw+tlVaGhJhk3mSaWScEywDflm8QPh1IuQI80wkQEaAKk7Ocvcznk31ZCFwUyBRmRMRDhnP/Cw6RvZzpkMJyQmZ09pCJXS6Zwzxfj/jlwRAOk1BLVDZ+9yJsMdWC5B7eBJk3VF/JjJCGuurAiZEaaqfIfCOOvBGHSlfuXxm8yBwlxRR+SPH3B1toUZsWUQlIZoY2XfsrMu439VDlSL/oOKVp9MhCSmSKCrTZMn0g4XBOWTtyZCjI4nEr50KJSY2gELTRdhbeuZMIM+rOCjt42xzdZNB5wsiM/eZDX2ghBBZ4mHxG2TyljPvceMiK5yG0IKYiUnEbQDiL5uSUZVBW4bZIwMpx3KjH8VIdQ+Yxph7GvRbkLEFGs32jBVOqtS6MohBorQtiAiquvA2rEW7dSLvzGRMf2J7HttiOrmug8GNqHYsR/B5IZQZHQZii5QcG2TQV67MbD1/seO0THr8E1EJduD6MfrWiiaecYLBbzDWyypo+ZVYA2icCIEzVZO/G6HteauZMBg96JfOVyvtzvAym6ymwfnjZW3phsiXqtvTf1R70MyfIjO4S6kgGEzV71DPxCR2RWSYJqwLrNvKvxye7fCnE2ZosbAdx9Vm7ZaBDUV9tdTQaD01aYc4sRiRdvaWVUw4GLaIOqAN2eqYkirqzaIKtx7JMX2ao1jQZaK/ZiLJpF16U4bQ6xP3zio/rTWbDHHl166kPvU1y5hjca54xHQWDGnseMiu3QpFDLu1FFQ80j2GwiA65iWhj1QkFMCqC+U7VzQlxWEQHUtk/N1HbY3OSzRIZUBBwxmaGKZJBH0hAAjnYmD9jvNS/xzKUCjVxXWZ1kgOLxVIfMgpkRtm2h8Quw6w7q2ZEjM0nOxFSgXIOLOp5bR5xLMBCOMC8LR5bhqXu+eip3NSDl1U/yPv6/8YDWnhHD0MJfXNNmQpda9uOukL4T0AZ+pClcwIQwmhAlhMCFMCIMJYUIYTAiDCWFCGEwIE8JgQpgQBhPChDCYEEYNww82H8iiVF14mTPVDAaDwWAwWsXfAgwAq0dnv94QwYAAAAAASUVORK5CYII=" width="17"/>
      </a>
     </div>
    </div>
   </div>
  </div>
  <script>
   function goShortURL_Header() {
			window.open("https://kuku.lu/?surl="+encodeURIComponent(location.href));
		}
  </script>
  <div id="area-master" style="min-height:50vh;">
   <div style="border-top:5px solid #FFCC33;">
    <div style="width:90%;max-width:1200px;margin: auto;">
     <div style="padding-top:10px;padding-bottom:10px;">
      <table border="0" cellpadding="0" cellspacing="0" width="100%">
       <tr>
        <td style="min-width:200px;height:75px;font-family: 'Hiragino Kaku Gothic Pro', 'ヒラギノ角ゴ Pro W3', メイリオ, Meiryo, 'ＭＳ Ｐゴシック', sans-serif;">
         <div class="titletext" style="font-size:25px;">
          <a href="https://m.kuku.lu/">
           捨てメアド
          </a>
         </div>
         <div class="titletext hidden_auto" style="font-size:12px;">
          多機能フリーメールサービス。メールアドレスは同時にいくつでも保有でき、期限もありません。登録も不要です。
         </div>
        </td>
        <td style="text-align:right;width:130px;max-width:130px;">
         <div class="buttonborder">
          <select data-theme="a" id="config_language" onchange="updateLanguage(this.value);" style="width:130px;padding:10px;">
           <option selected="" value="ja">
            日本語
           </option>
           <option value="en">
            English
           </option>
           <option value="ko">
            한국어
           </option>
           <option value="cn">
            简体中文
           </option>
           <option value="tw">
            繁體中文
           </option>
           <option value="hi">
            हिंदी
           </option>
           <option value="tr">
            Türkçe
           </option>
           <option value="id">
            Indonesia
           </option>
           <option value="es">
            Español
           </option>
           <option value="ru">
            Русский
           </option>
           <option value="pt">
            Português
           </option>
           <option value="fr">
            Français
           </option>
           <option value="de">
            Deutsch
           </option>
           <option value="ar">
            العربية
           </option>
           <option value="it">
            Italiano
           </option>
          </select>
         </div>
         <script>
          function updateLanguage(_newval) {
					$.ajax({
					    url: "./",
					    type: "POST",
					    data: "force_autolang=1&nopost=1&tar="+escape(_newval),
					    timeout: 4000
					}).done(function(data, status, xhr) {
						location.href = "./";
					}).fail(function(xhr, status, error) {
					});
				}
         </script>
        </td>
        <td style="text-align:right;width:110px;min-width:110px;">
         <a href="https://itunes.apple.com/app/shetemeado/id806157957?mt=8" target="_blank">
          <img border="0" src="img/appstore.png" style="" width="50"/>
         </a>
         <a href="https://play.google.com/store/apps/details?id=air.kukulive.mailnow" target="_blank">
          <img border="0" src="img/googleplay.png" style="" width="50"/>
         </a>
        </td>
       </tr>
      </table>
     </div>
     <div style="height:100px;max-height:100px;overflow:hidden;">
      <div style="margin:auto;padding-top:0px;padding-bottom:10px;text-align:center;">
       <script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
       </script>
       <!-- 捨てメアドR 上部 -->
       <ins class="adsbygoogle" data-ad-client="ca-pub-6235967741013519" data-ad-format="horizontal" data-ad-slot="5050180737" data-full-width-responsive="false" sandbox="allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" style="display:block;">
       </ins>
       <script>
        (adsbygoogle = window.adsbygoogle || []).push({});
       </script>
      </div>
     </div>
     <div>
      <div class="horizontal">
       <div class="horizontal" style="flex-grow:1;">
        <div onclick="flashThis(this);toggleMenu();" style="width:15%;min-width:75px;max-width:100px;text-align:center;cursor:pointer;">
         <div>
          <img border="0" class="mastermenuicon appbarbg ui-overlay-shadow" height="30" src="img/icon_menu.png" style="border-radius:5px;padding:8px;-ms-interpolation-mode: bicubic;" width="30"/>
         </div>
         <div class="deffont" style="font-size:80%;text-overflow:ellipsis;height:30px;margin-top:5px;overflow: hidden;white-space: nowrap;">
          設定
         </div>
        </div>
        <div onclick="flashThis(this);location.href='index.php';" style="width:15%;min-width:75px;max-width:100px;text-align:center;cursor:pointer;">
         <div>
          <a href="index.php">
           <img border="0" class="mastermenuicon appbarbg ui-overlay-shadow" height="30" src="img/icon_account.png" style="border-radius:5px;padding:8px;-ms-interpolation-mode: bicubic;" width="30"/>
          </a>
         </div>
         <div class="deffont" style="font-size:80%;text-overflow:ellipsis;height:30px;margin-top:5px;overflow: hidden;white-space: nowrap;">
          アドレス
         </div>
        </div>
        <div onclick="flashThis(this);location.href='recv.php';" style="width:15%;min-width:75px;max-width:100px;text-align:center;cursor:pointer;">
         <div>
          <a href="recv.php">
           <img border="0" class="mastermenuicon appbarbg ui-overlay-shadow" height="30" src="img/icon_recv.png" style="border-radius:5px;padding:8px;-ms-interpolation-mode: bicubic;" width="30"/>
          </a>
         </div>
         <div class="deffont" style="font-size:80%;text-overflow:ellipsis;height:30px;margin-top:5px;overflow: hidden;white-space: nowrap;">
          受信トレイ
         </div>
        </div>
        <div onclick="flashThis(this);location.href='send.php';" style="width:15%;min-width:75px;max-width:100px;text-align:center;cursor:pointer;">
         <div>
          <a href="send.php">
           <img border="0" class="mastermenuicon appbarbg ui-overlay-shadow" height="30" src="img/icon_send.png" style="border-radius:5px;padding:8px;-ms-interpolation-mode: bicubic;" width="30"/>
          </a>
         </div>
         <div class="deffont" style="font-size:80%;text-overflow:ellipsis;height:30px;margin-top:5px;overflow: hidden;white-space: nowrap;">
          送信トレイ
         </div>
        </div>
        <div style="width:15%;min-width:75px;max-width:100px;text-align:center;font-weight:bold;">
         <div>
          <a href="new.php">
           <img border="0" class="mastermenuicon appbarbg ui-overlay-shadow" height="30" src="img/icon_new.png" style="filter:contrast(150%);border-radius:5px;padding:8px;-ms-interpolation-mode: bicubic;" width="30"/>
          </a>
         </div>
         <div class="deffont" style="font-size:80%;text-overflow:ellipsis;height:30px;margin-top:5px;overflow: hidden;white-space: nowrap;">
          メール作成
         </div>
        </div>
       </div>
       <div class="horizontal" style="flex-grow:1;justify-content: flex-end;">
        <div id="pushsys_support" onclick="flashThis(this);togglePushButton();" style="width:15%;min-width:75px;max-width:100px;text-align:center;cursor:pointer;display:none;">
         <div id="pushsys_token_found" style="display:none;">
          <img border="0" class="mastermenuicon appbarbg ui-overlay-shadow" height="30" id="image_pushoff" src="img/icon_pushon.png" style="border-radius:5px;padding:8px;filter:contrast(150%);" width="30"/>
          <br/>
          <div class="deffont" style="font-size:80%;text-overflow:ellipsis;height:30px;margin-top:5px;overflow: hidden;white-space: nowrap;">
           通知
          </div>
         </div>
         <div id="pushsys_token_notfound" style="display:none;">
          <img border="0" class="mastermenuicon appbarbg ui-overlay-shadow" height="30" id="image_pushoff" src="img/icon_pushoff.png" style="border-radius:5px;padding:8px;" width="30"/>
          <br/>
          <div class="deffont" style="font-size:80%;text-overflow:ellipsis;height:30px;margin-top:5px;overflow: hidden;white-space: nowrap;">
           通知
          </div>
         </div>
         <script>
          function isPushApiSupported() {
							return 'PushManager' in window;
						}
						setTimeout(function(){
							try {
								if (isPushApiSupported()) {
									document.getElementById("pushsys_support").style.display = "block";
								}
							} catch(e) {
							}
						}, 500);
						
						function togglePushButton() {
							if ($("#pushsys_token_found").css("display") == "block") {
								requestPushUnsubcription();
							} else {
								initPush();
							}
						}
         </script>
        </div>
        <input id="pushsys_forcedisable" type="hidden" value=""/>
        <script>
         setInterval(function(){
						if ($("#pushsys_forcedisable").val() != "") {
							$("#pushsys_forcedisable").val("");
							
							isPushApiSupported = null;
							requestPushUnsubcription();
						}
					}, 200);
        </script>
       </div>
      </div>
     </div>
     <script>
      function flashThis(_obj) {
		_obj.style.opacity = "0.5";
		setTimeout(function(){_obj.style.opacity = "1";}, 100);
	}
	function configMailPage() {
		/*
		if (location.href.indexOf("recv.selectaddr.php") != -1) {
			location.href = "recv.php";
		} else if (location.href.indexOf("recv.php") != -1) {
			location.href = "recv.selectaddr.php";
		} else if (location.href.indexOf("send.selectaddr.php") != -1) {
			location.href = "send.php";
		} else if (location.href.indexOf("send.php") != -1) {
			location.href = "send.selectaddr.php";
		}
		*/
		
		toggleFilter();
		
		document.getElementById("image_config").style.opacity = "0.5";
		setTimeout(function(){document.getElementById("image_config").style.opacity = "1";}, 100);
	}

	function reloadMailPage() {
		if (location.href.indexOf("recv.selectaddr.php") != -1) {
			location.href = "recv.php";
		} else if (location.href.indexOf("recv.php") != -1) {
			reloadMail();
		} else if (location.href.indexOf("send.selectaddr.php") != -1) {
			location.href = "send.php";
		} else if (location.href.indexOf("send.php") != -1) {
			reloadMail();
		}
		
		//document.getElementById("image_reload").style.opacity = "0.5";
		//setTimeout(function(){document.getElementById("image_reload").style.opacity = "1";}, 100);
	}
	
	function logoutSystem() {
		if (confirm("現在のアドレスとメールが消えると困る場合は、現在のIDとパスワードを控えてからログアウトしてください。共有の端末を使用している場合は、他人の悪用を防ぐため必ずログアウトしておいてください。ログアウトを行いますか？")) {
			location.href="?action=logout";
		}
	}

	function menuMouse(_obj, _flag) {
		if (!_flag) {
			_obj.style.backgroundColor = "";
		} else {
			_obj.style.backgroundColor = "rgba(128,128,128,0.2)";
		}
	}
     </script>
     <script>
      navigator.registerProtocolHandler("mailto","https://m.kuku.lu/smphone.app.new.php?mailto_query=%s","捨てメアド");
     </script>
     <form action="/new.php" enctype="multipart/form-data" id="sendmail_form" method="post" name="sendmail_form" target="actionwin">
      <input name="action" type="hidden" value="sendMail"/>
      <input name="ajax" type="hidden" value="1"/>
      <input name="csrf_token_check" type="hidden" value="ce9b567751157a25cdcf886dd38d6da8"/>
      <input name="sendmail_replymode" type="hidden" value=""/>
      <input name="sendmail_replynum" type="hidden" value=""/>
      <input name="sendtemp_hash" type="hidden" value="5a91781ecd7c511263d308f1ecd33f63"/>
      <div id="area_new_prefix">
       <div class="defborder" style="padding:10px;">
        <table border="0" cellpadding="0" cellspacing="0" width="100%">
         <tr>
          <td class="deffont" style="font-weight:bold;width:30%;" valign="center">
           送信元アドレス:
          </td>
         </tr>
         <tr>
          <td id="area-myaddrlist" style="padding-top:8px;">
           <!-- [OK] -->
           <!-- メール送信時 / 譲渡選択時 / フォーム作成時 -->
           <input id="sendmail_from" name="sendmail_from" type="hidden" value=""/>
           <div style="margin-top:3px;">
            <div class="buttonborder" id="sendmail_from_selected">
             <a class="force_left" data-role="button" data-shadow="false" href="javascript:void(0);" id="sendmail_from_selected_item">
             </a>
            </div>
            <script>
             var id_to_value = new Array();
	 			var addrlist_keyvalue = "";
				function goAddrlistPageing(_param, _callback) {
					$.ajax({
					    url: "new._addrlist.php",
					    type: "GET",
					    data: "&keyname=sendmail_from&keyvalue="+addrlist_keyvalue+"&enable_newaddr=1&ajax=1&skip_searchbox=1&t="+((new Date()).getTime())+""+_param,
					    timeout: 10000,
					    cache: false
					}).done(function(data, status, xhr) {
						if (data.indexOf("[OK]") != -1) {
							$("#sendmail_from_list").html(data).trigger( "create" );
							$("#sendmail_from_list").scrollTop(0);
							changesendmail_from(true);
							
							_callback();
						} else {
							alert("システムエラーが発生しました。もう一度お試しください。");
							_callback(true);
						}
					}).fail(function(xhr, status, error) {
						//alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 302)");
						_callback(true);
					});
				}
				function goAddrlistPageingAddin(_param, _callback) {
					$.ajax({
					    url: "new._addrlist.php",
					    type: "GET",
					    data: "&keyname=sendmail_from&keyvalue=&ajax=1&skip_searchbox=1&t="+((new Date()).getTime())+""+_param,
					    timeout: 10000,
					    cache: false
					}).done(function(data, status, xhr) {
						if (data.indexOf("[OK]") != -1) {
							$("#sendmail_from_list").append(data).trigger( "create" );
							_callback();
						} else {
							alert("システムエラーが発生しました。もう一度お試しください。");
						}
					}).fail(function(xhr, status, error) {
						//alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 302)");
					});
				}
	 				
				$('#sendmail_from_selected_item').on('click', function(){
				    //togglesendmail_from();
				    openPopupMenu('#sendmail_from_master');
				    return false;
				});
	 			function togglesendmail_from() {
	 				/*
	 				if ($("#sendmail_from_master").css("display") == "none") {
	 					$("#sendmail_from_master").css("display", "block");
	 				} else {
	 					$("#sendmail_from_master").css("display", "none");
	 				}
	 				*/
	 			}
	 			function changesendmail_from(_no_close) {
	 				var _tar = $(':radio[name="sendmail_from_radio"]:checked')[0];
	 				if (!_tar) return;
	 				var _id = _tar.id;
	 				_id = _id.split("radio-").join("");
	 				$("#sendmail_from_selected_item").html(""+$("#"+_id).html());
	 				
	 				if (!_no_close) {
	 					//$("#sendmail_from_master").css("display", "none");
	 						 						closePopupMenu();
	 						 				}
	 				
	 				var _value = $(':radio[name="sendmail_from_radio"]:checked').val();
	 				$("#sendmail_from").val(_value);
	 				addrlist_keyvalue = encodeURIComponent(_value);
	 			}
	 			function searchsendmail_from(_q, _callback) {
	 				goAddrlistPageing('&addrlist_q='+encodeURIComponent(_q), _callback);
	 			}
	 			
	 			$(function(){
	 				goAddrlistPageing('');
	 				
 					tabRefreshQueue(function(){
 						goAddrlistPageing('');
 					});
	 			});
            </script>
            <div data-overlay-theme="b" data-role="popup" id="sendmail_from_master" style="">
             <div class="popupbox popupbox_auto">
              <div style="padding-bottom:4px;">
               <input class="defborder bigsearch addrlist-search" data-role="none" onchange="" onenter="return false;" placeholder="検索" type="input" value="">
               </input>
              </div>
              <div id="sendmail_from_list" style="height:400px;max-height:40vh;overflow-y:auto;">
              </div>
             </div>
            </div>
           </div>
          </td>
         </tr>
        </table>
       </div>
       <div style="padding-left:10px;padding-right:10px;padding-top:5px;">
        <div class="deffont" style="font-weight:bold;padding-top:20px;">
         送信先アドレス:
        </div>
       </div>
       <div class="defborder smfullborderbox" style="margin-top:10px;margin-bottom:10px;">
        <table border="0" cellpadding="0" cellspacing="0" style="width:100%;padding:0px;margin:0px;">
         <tr>
          <td class="simpleinput" style="background-color:white;">
           <input autocapitalize="off" class="noborderinput" data-role="none" data-shadow="false" id="sendmail_to" name="sendmail_to" onchange="SaveDataKeep(true);return true;" style="border:0px;padding:10px;font-size:110%;width:100%;" type="text" value=""/>
          </td>
          <td align="center" class="simpleinput" id="link_toaddr_openmenu" style="background-color:white;cursor:pointer;" width="60">
           <img border="0" src="img/menuopen.png" width="40"/>
           <script>
            $('#link_toaddr_openmenu').on('click', function(){
					    openPopupMenu("#popupMenu_to");
					    return false;
					});
           </script>
          </td>
         </tr>
        </table>
       </div>
       <div data-overlay-theme="b" data-role="popup" id="popupMenu_to">
        <div class="popupbox popupbox_auto">
         <div class="buttonborder" style="margin-bottom:5px;">
          <a class="force_left" data-icon="star" data-iconpos="left" data-role="button" data-shadow="false" href="javascript:void(0);" id="link_toaddr_fav">
           お気に入り
          </a>
         </div>
         <div class="buttonborder" style="margin-bottom:5px;">
          <a class="force_left" data-icon="user" data-iconpos="left" data-role="button" data-shadow="false" href="javascript:void(0);" id="link_toaddr_alias">
           別名
          </a>
         </div>
         <div class="buttonborder" style="margin-bottom:5px;">
          <a class="force_left" data-icon="clock" data-iconpos="left" data-role="button" data-shadow="false" href="javascript:void(0);" id="link_toaddr_send">
           送信履歴
          </a>
         </div>
         <div class="buttonborder" style="margin-bottom:5px;">
          <a class="force_left" data-icon="clock" data-iconpos="left" data-role="button" data-shadow="false" href="javascript:void(0);" id="link_toaddr_recv">
           受信履歴
          </a>
         </div>
         <div class="buttonborder" style="margin-bottom:5px;">
          <a class="force_left" data-icon="delete" data-iconpos="left" data-role="button" data-shadow="false" href="javascript:void(0);" id="link_toaddr_clear">
           クリア
          </a>
         </div>
        </div>
       </div>
       <script>
        $('#link_toaddr_paste').on('click', function(){
					closePopupMenu();
					clipboardGet('sendmail_to');
				    return false;
				});
				$('#link_toaddr_copy').on('click', function(){
					closePopupMenu();
					FlexCall('action=clipboardCopyEncode;text='+encodeURIComponent(''+document.getElementById('sendmail_to').value)+';');
				    return false;
				});
				$('#link_toaddr_fav').on('click', function(){
					closePopupMenu();
					changeAddressNoteSelecter('fav');
				    return false;
				});
				$('#link_toaddr_alias').on('click', function(){
					closePopupMenu();
					changeAddressNoteSelecter('alias');
				    return false;
				});
				$('#link_toaddr_send').on('click', function(){
					closePopupMenu();
					changeAddressNoteSelecter('send');
				    return false;
				});
				$('#link_toaddr_recv').on('click', function(){
					closePopupMenu();
					changeAddressNoteSelecter('recv');
				    return false;
				});
				$('#link_toaddr_clear').on('click', function(){
					closePopupMenu();
					document.getElementById('sendmail_to').value = '';
					//changeAddressNoteSelecter('');
				    return false;
				});
       </script>
       <div id="area_addresssearch" style="display:none;padding-left:10px;padding-right:10px;">
       </div>
       <div data-overlay-theme="b" data-role="popup" id="area_addressnote">
        <div class="popupbox popupbox_auto" id="area_addressnote_list">
        </div>
       </div>
       <div data-overlay-theme="b" data-role="popup" id="area_addressnote_alias">
        <div class="popupbox popupbox_auto">
         <div style="padding-bottom:10px;">
          <input id="search-basic" name="q" onchange="getAliasData(''+this.value);" placeholder="検索" type="search" value="">
          </input>
         </div>
         <div id="area_addressnote_alias_list" style="height:500px;max-height:60vh;overflow-y:auto;max-width:90vw;">
         </div>
        </div>
       </div>
       <script>
        var lock_searchToAddr = false;
				var old_searchToAddrQuery = "";
				function searchToAddr(_force) {
					var _q = document.getElementById("sendmail_to").value;
					if (!_force && old_searchToAddrQuery == _q) return;
					if (_q == "") {
						document.getElementById("area_addresssearch").style.display = "none";
						return;
					}
					
					console.log("searchToAddr: "+_q);
					lock_searchToAddr = true;
					old_searchToAddrQuery = _q;
					
					$.ajax({
					    url: "/new.php",
					    type: "GET",
					    data: "action=searchAddressNote&csrf_token_check=ce9b567751157a25cdcf886dd38d6da8&nopost=1&&q="+encodeURIComponent(_q),
					    timeout: 5000,
					    cache: false
					}).done(function(data, status, xhr) {
						lock_searchToAddr = false;
						if (data.indexOf("[OK]") != -1) {
							$("#area_addresssearch").html(data).trigger( "create" );
							document.getElementById("area_addresssearch").style.display = "block";
						} else {
							document.getElementById("area_addresssearch").style.display = "none";
						}
					}).fail(function(xhr, status, error) {
						lock_searchToAddr = false;
					});
				}
				setInterval(searchToAddr, 1000);
				
				var last_q = "";
				function getAliasData(_q) {
					last_q = _q;
					//if (_q == "") {
					//	$("#area_addressnote_alias_list").html("").trigger( "create" );
					//	return;
					//}
					$.ajax({
					    url: "aliaslist.php",
					    type: "GET",
					    data: "action=getAliaslist&csrf_token_check=ce9b567751157a25cdcf886dd38d6da8&nopost=1&&mode=new_page&q="+escape(_q),
					    timeout: 10000,
					    cache: false
					}).done(function(data, status, xhr) {
						if (data.indexOf("[OK]") != -1) {
							$("#area_addressnote_alias_list").html(data).trigger( "create" );
							openPopupMenu('#area_addressnote_alias');
						}
					}).fail(function(xhr, status, error) {
					    //alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 303)");
						viewError("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 303)", function(){
						});
					});
				}
				function selectAliasAddress(_addr) {
					updateSendAddr(_addr);
					
					//document.getElementById("area_addressnote_alias").style.display = "none";
					closePopupMenu();
				}
       </script>
       <script>
        function changeAddressNoteSelecter(_type) {
					if (_type == "none") {
						document.getElementById("area_addressnote").style.display = "none";
						document.getElementById("area_addressnote_alias").style.display = "none";
					} else if (_type == "alias") {
						document.getElementById("area_addressnote").style.display = "none";
						document.getElementById("area_addressnote_alias").style.display = "block";
						getAliasData(last_q);
					} else {
						document.getElementById("area_addressnote_alias").style.display = "none";
						getAddressNote(_type);
					}
				}
				function getAddressNote(_type) {
					$.ajax({
					    url: "/new.php",
					    type: "GET",
					    data: "action=getAddressNote2&csrf_token_check=ce9b567751157a25cdcf886dd38d6da8&nopost=1&&type="+encodeURIComponent(_type),
					    timeout: 10000,
					    cache: false
					}).done(function(data, status, xhr) {
						if (data.indexOf("#OK#") != -1) {
							$("#area_addressnote_list").html(''+data+'').trigger( "create" );
							document.getElementById("area_addressnote").style.display = "block";
							openPopupMenu('#area_addressnote');
						} else {
							//document.getElementById("area_addressnote").innerHTML = "<center>システムエラーが発生しました。もう一度お試しください。</center>";
							//document.getElementById("area_addressnote").style.display = "block";
						}
					}).fail(function(xhr, status, error) {
					});
				}
				function updateSendAddr(_addr) {
					document.getElementById("sendmail_to").value = ""+_addr;
					old_searchToAddrQuery = _addr;
					
					$("#addressnote_selecter").val("");
					
					document.getElementById("area_addresssearch").style.display = "none";
					
					document.getElementById("area_addressnote").style.display = "none";
					closePopupMenu();
					
					//document.getElementById("area_addresssearch").style.display = "none";
				}
				function favAddressNote(_addr, _obj) {
					$.ajax({
					    url: "/new.php",
					    type: "GET",
					    data: "action=favAddressNote&csrf_token_check=ce9b567751157a25cdcf886dd38d6da8&nopost=1&&addr="+encodeURIComponent(_addr),
					    timeout: 10000,
					    cache: false
					}).done(function(data, status, xhr) {
						if (data == "OK") {
							_obj.innerHTML="&#10003;";
							//alert("お気に入りアドレスリストに登録しました。");
						} else {
							//alert(data);
							viewError(data, function(){
							});
						}
					}).fail(function(xhr, status, error) {
					    //alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 304)");
						viewError("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 304)", function(){
						});
					});
				}
				function delAddressNote(_addr, _type, _callback) {
					$.ajax({
					    url: "/new.php",
					    type: "GET",
					    data: "action=delAddressNote&csrf_token_check=ce9b567751157a25cdcf886dd38d6da8&nopost=1&&addr="+encodeURIComponent(_addr)+"&type="+encodeURIComponent(_type),
					    timeout: 10000,
					    cache: false
					}).done(function(data, status, xhr) {
						if (data == "OK") {
							_callback();
							//getAddressNote(_type);
						} else {
							//alert(data);
							viewError(data, function(){
							});
						}
					}).fail(function(xhr, status, error) {
						viewError("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 305)", function(){
						});
					});
				}
       </script>
       <div style="padding-left:10px;padding-right:10px;">
        <div class="deffont" style="font-weight:bold;padding-top:20px;">
         メールタイトル:
        </div>
       </div>
       <div class="defborder smfullborderbox" style="margin-top:10px;margin-bottom:10px;">
        <table border="0" cellpadding="0" cellspacing="0" style="width:100%;padding:0px;margin:0px;">
         <tr>
          <td class="simpleinput" style="background-color:white;">
           <input autocomplete="off" class="noborderinput" data-role="none" id="sendmail_subject" name="sendmail_subject" onchange="SaveDataKeep(true);return true;" style="border:0px;padding:10px;font-size:110%;width:100%;border-radius:0px;" type="text" value=""/>
          </td>
         </tr>
        </table>
       </div>
       <div style="padding-left:10px;padding-right:10px;padding-top:20px;">
        <div class="flex-leftright">
         <div>
          <div class="deffont" style="font-weight:bold;">
           メール本文:
          </div>
         </div>
         <div>
          <div class="flex-right">
           <div style="margin-right:5px;">
            <a id="link_genautomail" style="cursor:pointer;">
             <img src="img/icon_ai.png?v=2" style="width:30px;border:0px;"/>
            </a>
           </div>
           <script>
            $('#link_genautomail').on('click', function(){
																			genAssistMail("");
										return;
																		
							   		openPopupMenu("#area_genautomail");
									
								    return false;
								});
								
								var autoreply_last_style = "";
								function genAssistMail(_style) {
									closePopupMenu();
									viewLoading();
									
									if (!_style) {
										if (getSendmailContent() == "") {
											viewError("まだ本文が記入されていないためアシスト機能を使用できません。", function(){
											});
											return;
										}
									}
									
									autoreply_last_style = _style;
									
									var _data = "&action=genAssistMail&style="+encodeURIComponent(_style);
																		_data += "&input_data="+encodeURIComponent(getSendmailContent());
									
									$.ajax({
									    url: "/new.php",
									    type: "POST",
									    data: _data,
									    dataType: "json",
									    timeout: 1000*129 //129sec
									}).done(function(data, status, xhr) {
										if (data["result"] == "OK") {
											$("#area_genautomail_result_content_text").val(data["res_text"].split("&gt;").join(">"));
											$("#area_genautomail_result_content").val(data["res"]);
											openPopupMenu("#area_genautomail_result");
										} else if (data["msg"]) {
											viewError(data["msg"], function(){
											});
										} else {
											viewError("システムエラーが発生しました。もう一度お試しください。", function(){
											});
										}
									}).fail(function(xhr, status, error) {
										viewError("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。", function(){
										});
									});
								}
           </script>
           <div data-overlay-theme="b" data-role="popup" id="area_genautomail" style="">
            <div class="popupbox popupbox_auto">
             <div class="area_genautomail_refacter">
              <div style="margin-bottom:10px;">
               現在入力中のメールを、より丁寧な表現に自動修正できます。
              </div>
              <div class="buttonborder" style="">
               <input data-icon="arrow-r" data-iconpos="right" data-shadow="false" onclick="genAssistMail('');" type="button" value="自動修正する"/>
              </div>
             </div>
            </div>
           </div>
           <div data-overlay-theme="b" data-role="popup" id="area_genautomail_result" style="">
            <div class="popupbox popupbox_auto">
             <div style="margin-bottom:10px;">
              この文章を使用しますか？
             </div>
             <div style="margin-bottom:10px;">
              <textarea id="area_genautomail_result_content_text" readonly="" style="padding:10px;border:1px solid gray;border-radius:6px;max-height:50%;"></textarea>
              <input id="area_genautomail_result_content" type="hidden" value=""/>
             </div>
             <div class="horizontal" style="padding-bottom:10px;justify-content: flex-start;">
              <div class="buttonborder" style="width:150px;">
               <a class="force_center" data-role="button" data-shadow="false" id="genautomail_result-regen">
                再生成
               </a>
              </div>
             </div>
             <div class="horizontal" style="justify-content: flex-end;">
              <div class="buttonborder" style="width:150px;margin-left:5px;">
               <a class="force_center" data-role="button" data-shadow="false" id="genautomail_result-ok">
                はい
               </a>
              </div>
              <div class="buttonborder" style="width:150px;margin-left:5px;">
               <a class="force_center" data-role="button" data-shadow="false" id="genautomail_result-cancel">
                いいえ
               </a>
              </div>
             </div>
            </div>
           </div>
           <script>
            $('#genautomail_result-regen').on('click', function(){
									closePopupMenu();
							   		genAssistMail(autoreply_last_style);
								    return false;
								});
								$('#genautomail_result-ok').on('click', function(){
									closePopupMenu();
							   		addSendmailContent($("#area_genautomail_result_content").val(), true);
								    return false;
								});
								$('#genautomail_result-cancel').on('click', function(){
							   		closePopupMenu();
								    return false;
								});
           </script>
           <div style="margin-right:5px;">
            <a id="link_newmail_togglehtml" style="cursor:pointer;">
             <img src="img/icon_html.png?v=1" style="width:30px;border:0px;"/>
            </a>
           </div>
           <script>
            $('#link_newmail_togglehtml').on('click', function(){
									toggleHTMLMode();
								    return false;
								});
           </script>
           <div style="margin-right:5px;">
            <a id="link_newmail_longmode" style="cursor:pointer;">
             <img src="img/icon_expand.png" style="width:30px;border:0px;"/>
            </a>
           </div>
           <script>
            $('#link_newmail_longmode').on('click', function(){
								toggleLongTextMode();
							    return false;
							});
           </script>
          </div>
         </div>
        </div>
       </div>
       <script>
        var timeout_autofitLongTextMode = false;
			function toggleLongTextMode() {
				if (document.getElementById("area_new_prefix").style.display == "none") {
					clearInterval( timeout_autofitLongTextMode );
					timeout_autofitLongTextMode = false;
					
					document.getElementById("area_new_prefix").style.display = "block";
					document.getElementById("area_new_suffix").style.display = "block";
					document.getElementById("sendmail_content").style.height = "400px";
					document.getElementById("area-longtextmode-close").style.display = "none";
				} else {
					document.getElementById("area_new_prefix").style.display = "none";
					document.getElementById("area_new_suffix").style.display = "none";
					document.getElementById("sendmail_content").style.height = "4000px";
					document.getElementById("area-longtextmode-close").style.display = "block";
					
					clearInterval( timeout_autofitLongTextMode );
					timeout_autofitLongTextMode = false;
					timeout_autofitLongTextMode = setInterval(autofitLongTextMode, 1000);
					autofitLongTextMode();
				}
			}
			function autofitLongTextMode(){
				var el = document.getElementById("sendmail_content");
				if(el.scrollHeight > el.offsetHeight){
					el.style.height = (el.scrollHeight+200) + 'px';
				} 
			}
       </script>
      </div>
      <div id="area-longtextmode-close" style="display:none;text-align:right;padding:10px;">
       <a id="link_newmail_longmode_close" style="cursor:pointer;">
        <img border="0" src="img/close.png" width="30"/>
       </a>
       <script>
        $('#link_newmail_longmode_close').on('click', function(){
			toggleLongTextMode();
		    return false;
		});
       </script>
      </div>
      <div class="defborder smfullborderbox" style="margin-top:10px;margin-bottom:10px;">
       <textarea class="simpleinput noborderinput" data-role="none" id="sendmail_content" name="sendmail_content" onchange="SaveDataKeep(true);return true;" style="font-size:110%;width:100%;height:300px;padding:10px;border:0px;border-radius:0px;"></textarea>
       <div class="simpleinput" id="area_content_editor" style="display:none;font-size:110%;width:100%;padding:10px;border:0px;border-radius:0px;">
       </div>
       <div class="simpleinput" id="area_originalview" style="display:none;">
       </div>
      </div>
      <style>
       .ql-editor{
				min-height:300px;
			}
			.ql-toolbar{
				border: 0px !important;
			}
			#sendmail_content{
				display:none;
			}
      </style>
      <link href="js/quill-1.3.6/quill.snow.css" rel="stylesheet"/>
      <script src="js/quill-1.3.6/quill.min.js">
      </script>
      <script src="js/quill.imageCompressor.min.js">
      </script>
      <script>
       var sendmail_content_mode = "text";
		
			$(function(){
				setTimeout(function(){
					var _content = getSendmailContent();
					if (isHTML(_content)) {
						//本文がHTML
						toggleHTMLMode();
					} else {
						//本文がテキスト、もしくは、なし
						
						if (localStorage["last_sendmail_content_mode"] == "html") {
							//最後にhtmlで使用していた
							toggleHTMLMode();
						} else {
							$("#sendmail_content").css("display", "block");
						}
					}
				}, 200);
			});
		
			function toggleHTMLMode() {
				if (sendmail_content_mode == "text") {
					switchHtmlMode();
					localStorage["last_sendmail_content_mode"] = "html";
				} else {
					switchTextMode();
					localStorage["last_sendmail_content_mode"] = "text";
				}
			}
			
			function switchTextMode() {
				if (!quill) return;
				
				var text = quill.getText();
				
				$("#sendmail_content").val(text);
				$("#area_content_editor").css("display", "none");
				$("#sendmail_content").css("display", "block");
				
				destory_editor("#area_content_editor");
				quill = false;
				
				sendmail_content_mode = "text";
			}
			
			var quill = false;
			function switchHtmlMode() {
				var _content = $("#sendmail_content").val();
				if (!isHTML(_content)) {
					_content = TextToHTML(_content);
				}
				
				$("#sendmail_content").css("display", "none");
				$("#area_content_editor").css("display", "block");
				
				$("#area_content_editor").html(_content);
					
				Quill.register("modules/imageCompressor", imageCompressor);
				
				var toolbarOptions = [
					['bold', 'italic', 'underline', 'strike'],        // toggled buttons
					['blockquote'],
					//[{ 'list': 'ordered'}, { 'list': 'bullet' }],
					
					[{ 'color': [] }, { 'background': [] }],

					[{ 'size': ['small', false, 'large', 'huge'] }],
					//[{ 'size': ['small', false, 'large', 'huge'] }],

					[{ 'align': [] }],

					//['image'],

					['clean']
				];
				
				quill = new Quill('#area_content_editor', {
					theme: 'snow',
					modules: {
						toolbar: toolbarOptions,
						imageCompressor: {
							quality: 0.8,
							maxWidth: 800,
							maxHeight: 600,
							imageType: 'image/jpeg'
						}
					}
				});
				quill.on('editor-change', function(eventName, args) {
					SaveDataKeep(true);
				});
				
				sendmail_content_mode = "html";
			}
				function isHTML(_str) {
					_str = _str.toLowerCase();
					if (_str.indexOf("</") == false) return false;
					
					var _tags = ["<!--", "<br", "<html", "<body", "<div", "<p", "<font", "<style", "<strong>", "<b>", "<a ", "<u>", "<s>", "<li>", "<ul>", "<ol>", "<h1>", "<h2>", "<h3>", "<h4>", "<h5>", "<table"];
					for (var i in _tags) {
						if (_str.indexOf(_tags[i]) != -1) return true;
					}
					
					return false;
				}
				
				function TextToHTML(_str) {
					var _lines = _str.split("\n");
					var _content = "";
					for (var i=0; i<_lines.length; i++) {
						_content += "<div>"+safestr(_lines[i])+"</div>"
					}
					
					return _content;
				}
				
				function destory_editor(selector){
				    if($(selector)[0])
				    {
				        var content = $(selector).find('.ql-editor').html();
				        $(selector).html(content);

				        $(selector).siblings('.ql-toolbar').remove();
				        $(selector + " *[class*='ql-']").removeClass (function (index, css) {
				           return (css.match (/(^|\s)ql-\S+/g) || []).join(' ');
				        });

				        $(selector + "[class*='ql-']").removeClass (function (index, css) {
				           return (css.match (/(^|\s)ql-\S+/g) || []).join(' ');
				        });
				    }
				    else
				    {
				        console.error('editor not exists');
				    }
				}
				function safestr(str){
				  return String(str).replace(/&/g,"&amp;")
				    .replace(/"/g,"&quot;")
				    .replace(/</g,"&lt;")
				    .replace(/>/g,"&gt;")
				}
			
			function getSendmailContent() {
				if (sendmail_content_mode == "html") {
					var _content = quill.root.innerHTML;
					_content = _content.split(' class="ql-align-right"').join(' style="text-align:right;"');
					_content = _content.split(' class="ql-align-left"').join(' style="text-align:left;"');
					_content = _content.split(' class="ql-align-center"').join(' style="text-align:center;"');
					_content = _content.split(' class="ql-size-small"').join(' style="font-size:50%;"');
					_content = _content.split(' class="ql-size-large"').join(' style="font-size:150%;"');
					_content = _content.split(' class="ql-size-huge"').join(' style="font-size:300%;"');

					if (_content == "<p><br></p>") {
						_content = "";
					}

					$("#sendmail_content").val(_content);
				}
				
				return $("#sendmail_content").val();
			}
			
			function addSendmailContent(_text, _replace) {
				if (sendmail_content_mode == "html") {
					var value = "";
					if (!_replace) {
						value = getSendmailContent();
					}
					if (!isHTML(_text)) {
						value += TextToHTML("\n"+_text);
					} else {
						value += "<div>&nbsp;</div>"+_text;
					}
					var delta = quill.clipboard.convert(value);
					quill.setContents(delta, 'silent');
				} else {
					if (_replace) {
						$("#sendmail_content").val(""+_text);
					} else {
						$("#sendmail_content").val(""+$("#sendmail_content").val()+"\n"+_text);
					}
				}
			}
      </script>
      <script>
       var defdata_sendmail_content = "";
	function initAutoCheckSaveDataKeep() {
		defdata_sendmail_content = getSendmailContent();
	}
	function checkAutoCheckSaveDataKeep() {
		if (timeoutSendMailHandle == false) {
			if (getSendmailContent() != defdata_sendmail_content) {
				SaveDataKeep(true);
			}
		}
		setTimeout(checkAutoCheckSaveDataKeep, 4000);
	}
	
	initAutoCheckSaveDataKeep();
	setTimeout(checkAutoCheckSaveDataKeep, 4000);
      </script>
      <div id="area_new_suffix">
       <div style="padding-left:10px;padding-right:10px;">
        <table border="0" cellpadding="0" cellspacing="0" width="100%">
         <tr>
          <td>
           <input id="sendmail_content_add" name="sendmail_content_add" type="hidden" value=""/>
          </td>
         </tr>
         <tr>
          <td class="deffont" style="font-weight:bold;padding-top:20px;padding-bottom:10px;" valign="center">
           添付ファイル:
          </td>
         </tr>
         <tr>
          <td>
           <script src="js/image-compressor/image-compressor.js?v=1">
           </script>
           <script>
            var init_uploadenable = false;
//var upload_server = [];
var upload_queue = [];
var xhr_slot = [];
var filedata = false;
var filedata_alt = [];
var filecnt = 0;
var filesize = 0;
var timer_checkQueue = false;
var upload_cancel = false;

function initUploader() {
	//ボタンを画像に変更
	$("#setup_file").on('click', function(){
		var $elm = $('#filedata');
		if (document.createEvent) {
			$elm.show();
			var e = document.createEvent('MouseEvents');
			e.initEvent('click', true, true );
			$elm.get(0).dispatchEvent(e);
			$elm.hide();
		}
		else {
			$elm.show();
			$elm.trigger("click");
			$elm.hide();
		}
		
		return false;
	});
	
	//fileタグが変更されたらアップロード開始
	$("#filedata").change(function(){
		startUploadEvent(uploadFile);
	});
}

$(function(){
	initUploader();
	
	setTimeout(function(){
		init_uploadenable = true;
		
				
	}, 500);
});

var directFileData = [];
	function getUploadBase64Queue(_data) {
		if (!_data) return;
		var _data = JSON.parse(_data);
		
		console.log("getUploadBase64Queue: action: "+_data["action"]+", name: "+_data["name"]+", size: "+_data["size"]+", type: "+_data["type"]);
		
		if (_data["action"] == "file") {
			for (var i=0; i<directFileData.length; i++) {
				if (directFileData[i].name == _data["name"]) {
					directFileData[i].data += _data["data"];
					return;
				}
			}
			
			directFileData.push({"name": _data["name"], "size": _data["size"], "data": _data["data"]});
		}
		if (_data["action"] == "upload") {
			finishUploadBase64();
		}
	}
	function finishUploadBase64() {
		console.log("finishUploadBase64()!");
		
		var _filedata_direct = [];
		for (var i=0; i<directFileData.length; i++) {
			var _index = _filedata_direct.length;
			_filedata_direct[_index] = toBlob(directFileData[i].data, directFileData[i].type);
			_filedata_direct[_index].name = directFileData[i].name;
			_filedata_direct[_index].size = directFileData[i].size;
			_filedata_direct[_index].type = directFileData[i].type;
		}

		startUploadEvent(function(){
			console.log("startUploadEvent callback");
			init_uploadenable = true;
			uploadFile(_filedata_direct);
		});
	}
		function toBlob(base64, type) {
		    var bin = atob(base64.replace(/^.*,/, ''));
		    var buffer = new Uint8Array(bin.length);
		    for (var i = 0; i < bin.length; i++) {
		        buffer[i] = bin.charCodeAt(i);
		    }
		    // Blobを作成
		    try{
		        var blob = new Blob([buffer.buffer], {
		            type: type
		        });
		    }catch (e){
		        return false;
		    }
		    return blob;
		}

function uploadFile(_filedata_direct) {
	console.log("uploadFile");
	
	//ファイルの圧縮と転送先取得
	if (!init_uploadenable) {
		console.log("uploadFile: cancel: !init_uploadenable");
		return; //戻るボタンで再アップを禁止
	}
	
	var _filedata = document.getElementById('filedata').files;
	upload_queue = [];
	
	var promises = [];
	
	$('.area_fileupload').css("display", "none");
	$('#area_waitupload').css("display", "block");
	$('#progressNumber').html("しばらくお待ちください...");
	$('#progressBar').css("width", "0%");
	
	filedata = _filedata;
	if (_filedata_direct) {
		filedata = _filedata_direct;
	}
	filedata_alt = [];
	for (var i=0; i<filedata.length; i++) {
		console.log(i, filedata[i]);
		if (!filedata[i].name || filedata[i].size <= 0) continue;
		
		filecnt ++;
		filesize += filedata[i].size;
		
		if (checkResampleEnable(filedata[i])) {
			//画像は圧縮
			console.log("compress("+filedata[i].size+"byte): ", filedata[i].name);
			var promise = new Promise(function(resolve, reject) {
			    const compressor = new ImageCompressor();
			    compressor.compress(filedata[i], {
			      quality: .95,
			      maxWidth: 1600,
			      maxHeight: 1600,
			      convertSize: 0,
			      success: function (result) {
			      	for (var n=0; n<filedata.length; n++) {
			      		if (result.name && filedata[n].name == result.name) {
			      			console.log("success(i="+n+","+result.size+"byte): ", result, filedata[n]);
			      			
			      			filedata_alt[n] = result;
			      			filesize -= (filedata[n].size - result.size);
			      		}
			      	}
			        resolve();
			      },
			      error: function (e) {
			        // 圧縮失敗の場合はそのまま
			        console.log("failed: ", e);
			        resolve();
			      }
			    });
			})
			promises.push(promise);
		}
		
		upload_queue[upload_queue.length] = {
			id: i,
			status: "wait",
			loaded: 0,
			server: false,
			url: "",
			hash: "",
		};
	}
	
	//圧縮などが済んだ
	Promise.all(promises).then(function(values){
		console.log("Promise: filecnt="+filecnt);
		
		if (filecnt <= 0) {
			uploadCancel();
			return;
		}
		
		try {
			SaveDataKeep(true);
		} catch(e) {
			console.log("SaveDataKeep() not found");
		}
		
		console.log("total filecnt="+filecnt+", filesize="+Math.round(filesize/(1024*1024))+"MB");
		console.log("upload_queue: ", upload_queue);
		
		var upload_files = {};
		for (var i in upload_queue) {
			var _fname = filedata[upload_queue[i].id].name;
			var _fsize = filedata[upload_queue[i].id].size;
			if (filedata_alt[upload_queue[i].id]) {
				var _fsize = filedata_alt[upload_queue[i].id].size;
			}
			
			upload_files[upload_queue[i].id] = {
				"filename": _fname,
				"size": _fsize
			};
		}
		
		//アップロード先を聞きに行く
		$.ajax({
		    url: "new._upload.php",
		    type: "POST",
		    data: "action=prepareUpload2&file_hash=5a91781ecd7c511263d308f1ecd33f63&totalcount="+filecnt+"&totalsize="+filesize+"&upload_files="+JSON.stringify(upload_files),
		    timeout: 10000,
		    dataType: "json"
		}).done(function(data, status, xhr) {
			if (data["result"] == "OK") {
				if (data["use_filenow"]) {
					//ファイルなう利用
					/*
					var _servers = _res["filenow_servers"].split(",");
		    		for (var i=0; i<_servers.length; i++) {
		    			upload_server[upload_server.length] = {
		    				"server": _servers[i],
		    				"use": 0,
		    			};
		    		}
		    		*/
		    		
		    		for (var i in data.servers) {
		    			upload_queue[i]["server"] = data.servers[i];
		    		}
				}
				
				upload_start_time = (new Date().getTime());
				if (timer_checkQueue) {
					clearInterval(timer_checkQueue);
				}
				timer_checkQueue = setInterval(checkQueue, 200);
			} else if (data["error"] == "fatal_sizeover") {
				//サイズか個数オーバー
				alert("10240MBまでのファイルを300個まで添付できます。（メールに添付できないファイルはダウンロードURLがメールに記載されます。）");
				uploadCancel();
			} else {
				alert("システムエラーが発生しました。もう一度お試しください。");
				uploadCancel();
			}
		}).fail(function(xhr, status, error) {
			alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。");
			uploadCancel();
		});
	});
}

	function checkQueue() {
		uploadProgress();
		
		//現在のパラレル数、完了数を取得
		var _now_upload_cnt = 0;
		var _now_complete_cnt = 0;
		for (var i=0; i<upload_queue.length; i++) {
			if (upload_queue[i].status == "upload") {
				_now_upload_cnt ++;
			} else if (upload_queue[i].status == "complete") {
				_now_complete_cnt ++;
			}
		}
		
		//全て完了
		if (_now_complete_cnt >= upload_queue.length) {
			//checkQueueを止める
			if (timer_checkQueue) {
				clearInterval(timer_checkQueue);
				timer_checkQueue = false;
			}
		
			uploadCancel();
			completeUploadEvent(upload_queue);
			
			return;
		}
		
		//パラレル数が4未満なら新規アップロード開始
		if (_now_upload_cnt < 4) {
			for (var n=0; n<(4-_now_upload_cnt); n++) {
				for (var i=0; i<upload_queue.length; i++) {
					if (upload_queue[i].status == "wait") {
						upload_queue[i].status = "upload";
						//upload_queue[i].server = getUploadServer(i);
						startUpload(i);
						break;
					}
				}
			}
		}
	}
	
		function uploadProgress() {
			var _totalloaded = 0;
			for (var i=0; i<upload_queue.length; i++) {
				_totalloaded += upload_queue[i].loaded;
			}
			var percentComplete = Math.round(_totalloaded * 100 / filesize);
			$('#progressBar').css("width", ""+percentComplete.toString()+"%");
			
			if (percentComplete >= 100) {
				$('#progressNumber').html('しばらくお待ちください...');
			} else {
				var _speed_bps = 0;
				try {
					if (upload_start_time && filesize && _totalloaded) {
						_speed_bps = (_totalloaded/(((new Date().getTime()) - upload_start_time)/1024));
					}
				} catch(e) {
					console.error(e);
				}
				
				$('#progressNumber').html(""+viewBytes(_totalloaded)+" / "+viewBytes(filesize)+" - "+viewBytes(_speed_bps, "KB")+"/s - "+ percentComplete.toString() + "％");
			}
		}
		
		/*
		function getUploadServer() {
			//ファイルなうサーバ情報がない場合は直接添付
			if (upload_server.length <= 0) {
				return "new._upload.php";
			}
			
			var _minuse = 999;
			var _target = 0;
			for (var i=0; i<upload_server.length; i++) {
				if (upload_server[i]["use"] < _minuse) {
					_minuse = upload_server[i]["use"];
					_target = i;
				}
			}
			
			upload_server[_target]["use"] ++;
			return "https://"+upload_server[_target]["server"]+"/upload.php";
		}
		*/
	
	function startUpload(_queue_pos) {
		//直接またはファイルなうにアップロード開始
		
		var _id = upload_queue[_queue_pos].id;
		console.log("startUpload", _id, upload_queue[_id]);
		//var _server_url = upload_queue[_id].server;
		
		var _method = "";
		var _file_key = "";
		if (upload_queue[_id]["server"]) {
			_method = upload_queue[_id]["server"]["method"];
			_file_key = upload_queue[_id]["server"]["file_key"];
		}
		
		var file = filedata[_id];
		var _file_size = file.size;
		if (filedata_alt[_id]) {
			_file_size = filedata_alt[_id].size;
		}
		
		xhr_slot[_id] = new XMLHttpRequest();
		var xhr = xhr_slot[_id];
		var promises = [];
		
		if (_method == "put") {
		} else {
			var fd = new FormData();
			fd.append("action", "uploadFile2");
			fd.append("service", "MailNow");
			fd.append("ajax", "1");
			fd.append("ajax_back", "1");
			fd.append("file_hash", "5a91781ecd7c511263d308f1ecd33f63");
			fd.append("filecnt", 1);
			//if (upload_server.length > 0) {
				fd.append("uuid", "6e82d6fbfd68e270e7fffa70f6148815");
			//}
		}
		
		xhr.upload.addEventListener("progress", function(e){
			upload_queue[_id].loaded = e.loaded;
		}, false);
		xhr.addEventListener("load", function(e){
			console.log("upload complete: ", _id, e);
			
			if (_method == "put") {
			    $.ajax({
			        url: "https://d.kuku.lu/_server.php",
			        type: 'POST',
			        cache: false,
			        dataType: "json",
			        data:"&action=registerFileByUser&service=MailNow&uuid=6e82d6fbfd68e270e7fffa70f6148815&file_key="+encodeURIComponent(_file_key),
			    }).done(function(data){
			    	if (data["result"] == "OK") {
						var _data = ""+data["url"]+",,"+filedata[_id]["name"]+",,"+_file_size+",,"+data["md5"];

						$.ajax({
						    url: "new._upload.php",
						    type: "POST",
						    data: "action=fileUploadCompletePass2&ajax=1&file_hash=5a91781ecd7c511263d308f1ecd33f63&data="+encodeURIComponent(_data),
						    timeout: 10000
						}).done(function(data, status, xhr) {
							var _res = data;
							upload_queue[_id].status = "complete";
							upload_queue[_id].url = data["url"];
							upload_queue[_id].hash = data["hash"];
						}).fail(function(xhr, status, error) {
							alert("システムエラーが発生しました。もう一度お試しください。");
							uploadCancel();
						});
						
			    	} else {
						alert("システムエラーが発生しました。もう一度お試しください。");
						uploadCancel();
			    	}
			    }).fail(function(){
					alert("システムエラーが発生しました。もう一度お試しください。");
					uploadCancel();
			    });
			    
			    return;
			}
			
			var _res = e.target.responseText;
			if (_method == "post") {
				//ファイルなうにアップロードした場合は１個ずつ登録しておく
				if (_res.indexOf("OK:") != -1) {
					var _data = _res.split("OK:").join("");
					
					$.ajax({
					    url: "new._upload.php",
					    type: "POST",
					    data: "action=fileUploadCompletePass2&ajax=1&file_hash=5a91781ecd7c511263d308f1ecd33f63&data="+encodeURIComponent(_data),
					    timeout: 10000
					}).done(function(data, status, xhr) {
						var _res = data;
						upload_queue[_id].status = "complete";
						upload_queue[_id].url = _res.replace("OK:", "");
						upload_queue[_id].hash = _res.replace("OK:https://d.kuku.lu/", "");
					}).fail(function(xhr, status, error) {
						alert("システムエラーが発生しました。もう一度お試しください。");
						uploadCancel();
					});
				} else {
					alert("システムエラーが発生しました。もう一度お試しください。");
					uploadCancel();
				}
				
				return;
			}
			
			//直接アップロードした場合は登録不要
			var _res = parseValue(_res);
			if (_res["result"] == "OK") {
				upload_queue[_id].status = "complete";
			} else if (_res["result"] == "NG" && _res["error_msg"]) {
				alert(""+_res["error_msg"]);
				uploadCancel();
			} else {
				alert("システムエラーが発生しました。もう一度お試しください。");
				uploadCancel();
			}
			
		}, false);
		xhr.addEventListener("error", function(e){
			if (!upload_cancel) {
				alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。");
				uploadCancel();
			}
			try {
				xhr_slot[_id].abort();
				xhr_slot[_id] = null;
			} catch(e) {
				console.log(e);
			}
		}, false);
		xhr.addEventListener("abort", function(e){
			if (!upload_cancel) {
				uploadCancel();
			}
			try {
				xhr_slot[_id].abort();
				xhr_slot[_id] = null;
			} catch(e) {
				console.log(e);
			}
		}, false);
		
		var file = filedata[_id];
		if (_method == "put") {
			xhr.open("PUT", upload_queue[_id]["server"]["url"]);
			
			if (filedata_alt[_id]) { //圧縮済みデータがある
				xhr.send(filedata_alt[_id]);
			} else {
				xhr.send(file);
			}
		} else {
			fd.append("file_1_name", file.name);
			fd.append("file_1_size", _file_size);
			fd.append("file_1_type", file.type);
			if (filedata_alt[_id]) { //圧縮済みデータがある
				fd.append("file_1", filedata_alt[_id]);
			} else {
				fd.append("file_1", file);
			}
			
			if (_method == "post") {
				xhr.open("POST", upload_queue[_id]["server"]["url"]);
			} else {
				xhr.open("POST", "new._upload.php");
			}

			//キャンセル済み
			if (upload_queue.length <= 0) return;
			xhr.send(fd);
		}
	}

	function uploadCancel() {
		console.log("uploadCancel()");
		
		upload_cancel = true;
		
		if (timer_checkQueue) {
			clearInterval(timer_checkQueue);
			timer_checkQueue = false;
		}
		
		$('.area_fileupload').css("display", "block");
		$('#area_waitupload').css("display", "none");

		console.log("xhr_slot: ", xhr_slot);
		for (var i=0; i<upload_queue.length; i++) {
			if (xhr_slot[upload_queue[i].id]) {
				try {
					xhr_slot[upload_queue[i].id].abort();
					xhr_slot[upload_queue[i].id] = null;
				} catch(e) {
					console.log(e);
				}
			}
		}
		xhr_slot = [];
		
		//upload_server = [];
		//upload_queue = [];
		filedata = false;
		filecnt = 0;
		filesize = 0;
		
		$("#filedata").val("");
		
		upload_cancel = false;
	}
	
function filenowGenList(_callback) {
	//完了済みファイルURLを単一リストURLに変換
	
	var _hashlist = "";
	for (var i=0; i<upload_queue.length; i++) {
		if (upload_queue[i].status == "complete") {
			if (!upload_queue[i].hash) continue;
			if (_hashlist) _hashlist += ",";
			_hashlist += upload_queue[i].hash;
		}
	}

	$.ajax({
	    url: "new._upload.php",
	    type: "POST",
	    data: "action=filenowReglist&ajax=1&link_hash="+encodeURIComponent(_hashlist)+"&file_hash=skip&uuid=6e82d6fbfd68e270e7fffa70f6148815",
	    dataType:"json",
	    timeout: 10000
	}).done(function(data, status, xhr) {
		if (data["result"] == "OK") {
			_callback(data["url"]);
		} else {
			alert("システムエラーが発生しました。もう一度お試しください。");
			uploadCancel();
		}
	}).fail(function(xhr, status, error) {
		alert("システムエラーが発生しました。もう一度お試しください。");
		uploadCancel();
	});
}
	
//------------------------------------------------------
// 汎用
//------------------------------------------------------

function viewBytes(num, _format) {
	var _suff = "KB";
	if (num >= 1024*1024 && (!_format || _format == "MB")) { //MB
		num = Math.round((num) / (1024*1024));
		_suff = "MB";
	} else { //KB
		num = Math.round((num) / 1024);
		_suff = "KB";
	}
	
    return ""+(String(num).replace( /(\d)(?=(\d\d\d)+(?!\d))/g, '$1,'))+" "+_suff;
}

function checkResampleEnable(_file) {
	if ($("#upload_no_compress").val() == "1") {
		return false;
	}
	
	if (_file.type == "image/png") {
		if (_file.size >= 1024*1024*1) {
			return true;
		}
		return false;
	}
	if (_file.type == "image/jpeg") {
		if (_file.size >= 1024*512) {
			return true;
		}
		return false;
	}
	
	return false;
}
           </script>
           <script>
            function startUploadEvent(_callback) {
						registFileHashToken(function(){
							_callback();
						});
					}
					function completeUploadEvent(_files) {
						//アップロード完了した
						
						checkUploadFileForce();
					}
           </script>
           <div style="">
            <div class="area_fileupload buttonborder">
             <label class="file_mask">
              <input id="setup_file" type="button" value="ファイルの直接選択"/>
             </label>
             <div style="display:none;">
              <input id="filedata" multiple="multiple" name="sendmail_file_tmp[]" type="file">
              </input>
             </div>
            </div>
           </div>
           <div id="area_waitupload" style="display:none;padding:5px;text-align:center;">
            ファイルを送信中です...
            <div style="padding-top:10px;padding-bottom:10px;">
             <div style="background-color:rgba(128,128,128,0.1);border-radius:5px;">
              <div class="popbg" id="progressBar" style="width:0%;height:15px;border-radius:5px;">
              </div>
             </div>
            </div>
            <div id="progressNumber">
            </div>
            <br/>
            <div class="buttonborder" style="display:inline-block;width:150px;">
             <a class="force_center" data-mini="true" data-role="button" data-shadow="false" id="link_newmail_attach_cancel" style="cursor:pointer;">
              キャンセル
             </a>
            </div>
            <script>
             $('#link_newmail_attach_cancel').on('click', function(){
								uploadCancel();
							    return false;
							});
            </script>
           </div>
           <div style="padding-top:6px;">
            <div id="area_uploaded_file">
            </div>
            <script>
             //$('#uploadFileName').on('click', function(){
						//	openAttachDetail();
						//    return false;
						//});
            </script>
            <input name="file_hash" type="hidden" value="5a91781ecd7c511263d308f1ecd33f63"/>
            <script>
             function registFileHashToken(_callback) {
					$.ajax({
					    url: "/new.php",
					    type: "POST",
					    data: "action=registFileHashToken&nopost=1&file_hash=5a91781ecd7c511263d308f1ecd33f63&csrf_token_check=ce9b567751157a25cdcf886dd38d6da8&t="+((new Date()).getTime()),
					    timeout: 5000,
					    cache: false
					}).done(function(data, status, xhr) {
						if (_callback) {
							_callback();
						}
					}).fail(function(xhr, status, error) {
						//alert("システムエラーが発生しました。もう一度お試しください。");
						viewError("システムエラーが発生しました。もう一度お試しください。", function(){
						});
					});
				}
					
				function openAttachDetail() {
					updateSendTemp();
					initCheckUploadFile();
					
					registFileHashToken(function(){
													//PC
							CookieQuery("file_hash=5a91781ecd7c511263d308f1ecd33f63&autolang=ja");
							//ActionWinOpen('https://m.kuku.lu/new._upload.php');
							openAlertDialog("<iframe src='https://m.kuku.lu/new._upload.php?iframe=1&dummy_path=new.php' style='width:100%;height:600px;max-height:90%;border:0px;' border='0'></iframe>", function(){
							});
											});
				}
					
				var enableCheckUploadFile = false;
				function initCheckUploadFile() {
					if (enableCheckUploadFile) return;
				
					enableCheckUploadFile = true;
					setTimeout(checkUploadFile, 500);
				}
				function checkUploadFile() {
					if (!document.hasFocus()) {
						setTimeout(checkUploadFileForce, 3000);
					} else {
						setTimeout(checkUploadFileForce, 100);
					}
				}
				
				var last_checkUploadFileResult = "";
				function checkUploadFileForce() {
					$.ajax({
					    url: "/new.php",
					    type: "POST",
					    data: "action=checkUploadFile2&nopost=1&&sendtemp_hash=5a91781ecd7c511263d308f1ecd33f63&csrf_token_check=ce9b567751157a25cdcf886dd38d6da8&t="+((new Date()).getTime()),
					    timeout: 5000,
					    cache: false,
					    dataType: "json"
					}).done(function(data, status, xhr) {
						
						setTimeout(checkUploadFile, 2500);
						
						var _dataString = JSON.stringify(data);
						if (_dataString == last_checkUploadFileResult) {
							return;
						}
						last_checkUploadFileResult = _dataString;
						
						if (data["cnt"] > 0) {
							var _buffer = '';
							for (var i in data["files"]) {
								var _tar = data["files"][i];
								var _deleteFunc = "deleteUploadFile('"+_tar["tmp_name"]+"');";
								var _openFunc = "ActionWinOpen('"+_tar["url"]+"');";
								_buffer += '<div id="area_view_'+_tar["key"]+'" class="buttonborder" style="display:block;margin-bottom:5px;">';
								_buffer += '	<div class="horizontal" style="align-items: stretch;">';
								_buffer += '		<div style="width:47px;min-width:47px;min-height:47px;align-self: stretch;position:relative;">';
								_buffer += '			<div style="position:absolute;margin:auto;top:0;bottom:0;left:0;right:0;">';
								_buffer += '				<a data-role="button" href="javascript:'+_deleteFunc+'" data-icon="delete" class="defborder" style="margin:0;padding:0;height:100%;width:100%;border-top-left-radius:0;border-bottom-left-radius:0;">&nbsp;</a>';
								_buffer += '			</div>';
								_buffer += '		</div>';
								_buffer += '		<div style="flex-grow:1;" class="buttonbg">';
								_buffer += '			<div style="padding:10px;">';
								_buffer += '				<a href="javascript:'+_openFunc+'" style="word-break: break-all;">'+_tar["filename"]+'</a> ';
								_buffer += '				('+_tar["size_view"]+')';
								_buffer += '			</div>';
								_buffer += '		</div>';
								_buffer += '	</div>';
								_buffer += '</div>';
							}
							
							_buffer += "<div><a href='javascript:openAttachDetail();'>"+data["message"]+"</a></div>";
							$("#area_uploaded_file").html(""+_buffer).trigger( "create" );
						} else {
							$("#area_uploaded_file").html("<a href='javascript:openAttachDetail();'>添付ファイルなし</a>");
						}
					}).fail(function(xhr, status, error) {
						setTimeout(checkUploadFile, 2500);
					});
				}
				function deleteUploadFile(_target) {
					$.ajax({
					    url: "smphone.app.new._upload.php",
					    type: "POST",
					    data: "file_hash=5a91781ecd7c511263d308f1ecd33f63&action=deleteFile&target="+encodeURIComponent(_target),
					    timeout: 10000
					}).done(function(data, status, xhr) {
						checkUploadFileForce();
					}).fail(function(xhr, status, error) {
					});
				}
				//initCheckUploadFile();
				setTimeout(checkUploadFileForce, 2000);
            </script>
           </div>
          </td>
         </tr>
        </table>
        <br/>
       </div>
       <div style="padding-left:10px;padding-right:10px;">
        <script defer="" src="https://challenges.cloudflare.com/turnstile/v0/api.js">
        </script>
        <div class="cf-turnstile" data-sitekey="0x4AAAAAAA6rBEmawKRBvY-Z" data-theme="light">
        </div>
        <div class="buttonborder" id="area_sendbutton" style="margin-top:10px;">
         <input data-icon="check" data-iconpos="right" data-shadow="false" onclick="checkSendMail(false);" style="text-align:left;" type="button" value="メールを送信"/>
        </div>
        <div class="buttonborder" id="area_sendtemp_button" style="margin-top:30px;">
         <input data-mini="true" data-shadow="false" onclick="updateSendTempManual();" style="text-align:left;" type="button" value="下書きに保存"/>
        </div>
        <div class="normal" id="area_wait" style="display:none;color:green;text-align:center;">
         <div style="text-align:center;color:gray;">
          <div class="loader">
           Loading...
          </div>
         </div>
         メールを送信中です...
        </div>
        <br/>
       </div>
      </div>
     </form>
     <script>
      function SaveDataKeep(_flag) {
	console.log("SaveDataKeep: "+_flag);
	if (_flag) {
		$("#area_sendtemp_button").css("display", "block");
		
		FlexCall('action=SaveDataKeep;mode=on;');
	} else {
		$("#area_sendtemp_button").css("display", "none");
		initAutoCheckSaveDataKeep();
		
		FlexCall('action=SaveDataKeep;mode=off;');
	}
}
function confirmSaveDataKeep(_accessurl) {
	if (confirm("作成中のメールはまだ送信されておらず、下書きにも保存されていませんが移動してもよろしいですか？")) {
		SaveDataKeep(false);
		
		if (_accessurl == "backpage") {
							setTimeout(function(){ Android.goback(); },100);
					} else {
			setTimeout(function(){
				location.href = ""+_accessurl;
			}, 100);
		}
	}
}
	
function restoreSendMail() {
	clearTimeout(timeoutSendMailHandle);
	timeoutSendMailHandle = false;
	
	document.getElementById("area_sendbutton").style.display = "block";
	//document.getElementById("area_wait").style.display = "none";
	closePopupMenu();
}
function unlockSendMail() {
	clearTimeout(timeoutSendMailHandle);
	timeoutSendMailHandle = false;
	
	//document.getElementById("area_wait").style.display = "none";
	closePopupMenu();
}
function completeSendMail() {
	unlockSendMail();
	location.href="/new.php";
}

var timeoutSendMailHandle = false;
var confirmEULA = "";
function checkSendMail(_confirm) {
	var _confirmmsg = "送信してもよろしいですか？";
	
	if ($("#area_waitupload").length > 0) {
		if ($("#area_waitupload").css("display") == "block") {
			viewError("アップロードが完了するまでお待ちください。", function(){
			});
			return;
		}
	}
	
	if (confirmEULA != "1") {
		openConfirmDialogHTML(
			'利用規約に同意していただけますか？<br><a href="https://aquapal.net/rule.php" target="_blank">利用規約を確認する</a>', 
			function(){
				confirmEULA = "1";
				
				$.ajax({
				    url: "index.php",
				    type: "GET",
				    data: "action=agreeEULA&nopost=1&by_system=1&csrf_token_check=ce9b567751157a25cdcf886dd38d6da8",
				    timeout: 10000,
				    cache: false
				}).done(function(data, status, xhr) {
					checkSendMail();
				}).fail(function(xhr, status, error) {
				    alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。");
				});
			},
			function() {
			}
		);
		return;
	}
	
		
	if (document.getElementById("sendmail_to").value.indexOf("@") == -1 && document.getElementById("sendmail_to").value.indexOf("＠") == -1) {
		_confirmmsg = "送信先メールアドレスが記入されていません。自分宛に送信しますか？";
	}
	
	if (document.getElementById("sendmail_from").value != "newaddr" && document.getElementById("sendmail_from").value.indexOf("@") == -1) {
		//alert("送信元メールアドレスが選択されていません。");
		viewError("送信元メールアドレスが選択されていません。", function(){
		});
	} else {
		if (!_confirm) {
			openConfirmDialog(
				_confirmmsg, 
				function(){
					checkSendMail(true);
				},
				function() {
				}
			);
			return;
		}
		
		document.getElementById("area_sendbutton").style.display = "none";
		
		if (document.getElementById("sendmail_from").value == "newaddr") {
			addMailAddrByAuto();
			return;
		}
		
		runSendMail();
	}
}

//送信実行
function runSendMail() {
	document.getElementById("area_sendbutton").style.display = "none";
	viewLoading();
	
	SaveDataKeep(false);
	
	//htmlモードの場合対策
	getSendmailContent();
	
	$.ajax({
	    url: "/new.php",
	    type: "POST",
	    data: $("#sendmail_form").serialize(),
	    dataType: "json",
	    timeout: 1000*29 //29sec
	}).done(function(data, status, xhr) {
		console.log("runSendMail(): Done: ", data);
		
		if (data.result == "OK") {
			unlockSendMail();
							setTimeout(function(){
					if (data.msg) {
						alert(data.msg);
					}
					completeSendMail();
				}, 100);
					} else if (data.msg) {
			restoreSendMail();
			setTimeout(function(){
				//alert(data.msg);
				
				viewError(data.msg, function(){
				});
											
				if (data.msg.toLowerCase().indexOf("recaptcha") != -1) {
					$("#area_recaptcha_v2").css("display", "block");
				}
			}, 100);
		} else {
			restoreSendMail();
			setTimeout(function(){
				viewError("システムエラーが発生しました。もう一度お試しください。", function(){
				});
				//alert("システムエラーが発生しました。もう一度お試しください。");
			}, 100);
		}
	}).fail(function(xhr, status, error) {
		console.log("runSendMail(): Fail");
		
		restoreSendMail();
		setTimeout(function(){
			//alert("システムエラーが発生しました。もう一度お試しください。");
			viewError("システムエラーが発生しました。もう一度お試しください。", function(){
			});
		}, 100);
	});
	
	//タイムアウト
	clearTimeout(timeoutSendMailHandle);
	timeoutSendMailHandle = setTimeout(timeoutSendMail, 1000*30); //30秒後
}

var timer_newaddrauto = false;
function addMailAddrByAuto() {
	$.ajax({
	    url: "index.php",
	    type: "GET",
	    data: "action=addMailAddrByAuto&nopost=1&by_system=1&csrf_token_check=ce9b567751157a25cdcf886dd38d6da8",
	    timeout: 10000,
	    cache: false
	}).done(function(data, status, xhr) {
		if (data.indexOf("OK:") != -1) {
			//作成完了
			var _tmp = data.split("OK:");
			goAddrlistPageing('&page=&keyvalue='+encodeURIComponent(_tmp[1]));
			
			clearInterval(timer_newaddrauto);
			timer_newaddrauto = setInterval(function(){
				if (document.getElementById("sendmail_from").value == _tmp[1]) {
					clearInterval(timer_newaddrauto);
					runSendMail();
				}
			}, 500);
		} else {
	 	   alert(data);
		}
	}).fail(function(xhr, status, error) {
	    alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。");
	});
}

function timeoutSendMail() {
	restoreSendMail();
		
	//alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 300)");
	viewError("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 300)", function(){
	});
}

var _oldparam = "";
function updateSendTemp() {
	if (timeoutSendMailHandle) return;
	
	var _from = "";
	var _to = "";
	var _subject = "";
	var _content = "";
	var _content_add = "";
	
	try {
		_from = document.getElementById("sendmail_from").value;
		_to = document.getElementById("sendmail_to").value;
		_subject = document.getElementById("sendmail_subject").value;
		//_content = document.getElementById("sendmail_content").value;
		_content = getSendmailContent();
		_content_add = document.getElementById("sendmail_content_add").value;
	} catch(e) {
		if (sendtemp_manual) {
			sendtemp_manual = false;
			//alert("システムエラーが発生しました。もう一度お試しください。 (code: 300a)");
			viewError("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 301)", function(){
			});
		}
		return;
	}
	
	if (_content == "" && _subject == "" && _to == "") {
		
		if (sendtemp_manual) {
			sendtemp_manual = false;
			//alert("未記入の状態では下書きに保存できません。");
			viewError("未記入の状態では下書きに保存できません。", function(){
			});
		}
		
		//clearTimeout(timer_updateSendTemp);
		//setTimeout(updateSendTemp, 6000);
		return;
	}
	
	var _param = "&from="+encodeURIComponent(_from);
	_param += "&to="+encodeURIComponent(_to);
	_param += "&subject="+encodeURIComponent(_subject);
	_param += "&content="+encodeURIComponent(_content);
	_param += "&content_add="+encodeURIComponent(_content_add);
	_param += "&save_action=";
	_param += "&save_num=";
	
	if (_oldparam != _param)
	{
		console.log("updateSendTemp(): Send!");
		
		$.ajax({
		    url: "/new.php",
		    type: "POST",
		    data: "action=updateSendTemp&nopost=1&csrf_token_check=ce9b567751157a25cdcf886dd38d6da8&sendtemp_hash=5a91781ecd7c511263d308f1ecd33f63"+_param,
		    timeout: 10000
		}).done(function(data, status, xhr) {
			console.log("updateSendTemp(): Done");
			
			if (data == "OK") {
				SaveDataKeep(false);
			} else {
				if (sendtemp_manual) {
					sendtemp_manual = false;
					//alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 303)");
					viewError("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 303)", function(){
					});
				}
			}
			
			if (sendtemp_manual) {
				sendtemp_manual = false;
			}
		}).fail(function(xhr, status, error) {
			console.log("updateSendTemp(): Fail");
			
			if (sendtemp_manual) {
				sendtemp_manual = false;
				//alert("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 301)");
				viewError("操作に失敗しました。インターネット接続が安定している場所で再度お試しください。 (code: 301)", function(){
				});
			}
		});
	} else {
		console.log("updateSendTemp(): Pass");
		
		SaveDataKeep(false);
		
		if (sendtemp_manual) {
			sendtemp_manual = false;
		}
	}
	
	_oldparam = _param;
}
//var timer_updateSendTemp = setTimeout(updateSendTemp, 6000);

	var sendtemp_manual = false;
	function updateSendTempManual() {
		sendtemp_manual = true;
		updateSendTemp();
	}
     </script>
     <script>
      //----------------------------------------------------------------
//Fingerprint
var fingerprint = "";
try {
    setTimeout(function () {
        parseFinger();
    }, 100);
} catch(e) {
	console.error("finger: ", e);
}
function parseFinger() {
	if (fingerprint) return;
	
	var cpu = 0;
	
	try {
		cpu = window.navigator.hardwareConcurrency;
	} catch(e) {
		console.error(e);
	}
	
	var screen_width = 0;
	var screen_height = 0;
	
	try {
		screen_width = window.parent.screen.width;
		screen_height = window.parent.screen.height;
		
		if (screen_height > screen_width) {
			var _tmp = screen_height;
			screen_height = screen_width;
			screen_width = _tmp;
		}
	} catch(e) {
		console.error(e);
	}
	
	var vendor = "";
	var renderer = "";

	try {
		var canvas = document.createElement('canvas');
		var gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');
		var debugInfo = gl.getExtension('WEBGL_debug_renderer_info');
		vendor = gl.getParameter(debugInfo.UNMASKED_VENDOR_WEBGL);
		renderer = gl.getParameter(debugInfo.UNMASKED_RENDERER_WEBGL);
	} catch (e) {
		console.error(e);
	}
	
	var _res = "";
	if (cpu > 0) {
		_res += "("+cpu+"c)";
	}
	if (screen_width > 0 && screen_height > 0) {
		_res += "("+screen_width+"x"+screen_height+")";
	}
	if (vendor != "" || renderer != "") {
		
		var _tmp = "";
		if (vendor != "" && renderer == "") {
			_tmp = ""+vendor;
		} else if (vendor == "" && renderer != "") {
			_tmp = ""+renderer;
		} else {
			_tmp = ""+vendor+", "+renderer+"";
		}
		
  		_tmp = _tmp.split("Google Inc.").join("");
  		_tmp = _tmp.split("(").join("");
  		_tmp = _tmp.split(")").join("");
  		_tmp = _tmp.split("~Google ").join("");
  		_tmp = _tmp.split("~ANGLE ").join("");
  		_tmp = _tmp.split("(TM)").join("");
  		_tmp = _tmp.split("(R)").join("");
		
		_res += "("+_tmp+")";
	}
	
	if (_res != "") {
		fingerprint = _res;
		resFinger();
	}

}

function resFinger() {
	if (!fingerprint || fingerprint == "") return;
	
	cookie.set("ffucs", btoa(fingerprint));
	//document.getElementById("ffucs_form").value = ""+btoa(fingerprint);
}
//----------------------------------------------------------------
     </script>
     <div data-overlay-theme="b" data-role="popup" id="area-loading-dialog">
      <div class="loader" id="area-loading-dialog-loading" style="display:none;">
       Loading...
      </div>
     </div>
     <div data-overlay-theme="b" data-role="popup" id="area-confirm-dialog">
      <div class="popupbox popupbox_auto">
       <div class="normal">
        <div id="area-confirm-dialog-data">
        </div>
        <br/>
        <div class="horizontal" style="padding-top:10px;justify-content: flex-end;">
         <div class="buttonborder" style="width:150px;">
          <a class="force_center" data-role="button" data-shadow="false" id="area-confirm-dialog-button-ok">
           はい
          </a>
         </div>
         <div class="buttonborder" style="width:150px;margin-left:10px;">
          <a class="force_center" data-role="button" data-shadow="false" id="area-confirm-dialog-button-cancel">
           いいえ
          </a>
         </div>
        </div>
        <script>
         $('#area-confirm-dialog-button-ok').on('click', function(){
				    okConfirmDialog();
				    return false;
				});
				$('#area-confirm-dialog-button-cancel').on('click', function(){
				    cancelConfirmDialog();
				    return false;
				});
        </script>
       </div>
      </div>
     </div>
     <script>
      var confirmdialog_ok_lastcallback = false;
	var confirmdialog_cancel_lastcallback = false;
	function openConfirmDialog(_data, _callback_ok, _callback_cancel) {
					openConfirmDialogHTML(_data, _callback_ok, _callback_cancel);
					
			}
	
	function openConfirmDialogHTML(_data, _callback_ok, _callback_cancel, _label_ok, _label_cancel) {
		confirmdialog_ok_lastcallback = _callback_ok;
		confirmdialog_cancel_lastcallback = _callback_cancel;
		
		$("#area-confirm-dialog-button-ok").html("はい");
		if (_label_ok) {
			$("#area-confirm-dialog-button-ok").html(""+_label_ok);
		}
		$("#area-confirm-dialog-button-cancel").html("いいえ");
		if (_label_cancel) {
			$("#area-confirm-dialog-button-cancel").html(""+_label_cancel);
		}
		
		$("#area-confirm-dialog-data").html(""+_data).trigger( "create" );
		openPopupMenu("#area-confirm-dialog");

			}
	
		function okConfirmDialog() {
			//$("#area-confirm-dialog").popup("close");
			closePopupMenu();
			confirmdialog_ok_lastcallback();
		}

		function cancelConfirmDialog() {
			//$("#area-confirm-dialog").popup("close");
			closePopupMenu();
			confirmdialog_cancel_lastcallback();
		}
     </script>
     <div data-overlay-theme="b" data-role="popup" id="area-alert-dialog">
      <div class="popupbox popupbox_auto">
       <div class="normal">
        <div id="area-alert-dialog-data">
        </div>
        <div class="horizontal" id="master-alert-dialog-button-ok" style="padding-top:10px;justify-content: flex-end;">
         <div class="buttonborder" style="width:200px;margin-left: auto;">
          <a class="force_center" data-role="button" data-shadow="false" id="area-alert-dialog-button-ok">
           OK
          </a>
         </div>
        </div>
        <script>
         $('#area-alert-dialog-button-ok').on('click', function(){
				    okAlertDialog();
				    return false;
				});
        </script>
       </div>
      </div>
     </div>
     <script>
      var alertdialog_ok_lastcallback = false;
	function openAlertDialog(_data, _callback_ok) {
		alertdialog_ok_lastcallback = _callback_ok;
		
		$("#area-alert-dialog-data").html(""+_data).trigger( "create" );
		openPopupMenu("#area-alert-dialog");
		
		//$("#area-alert-dialog").popup("close");
		//$("#area-loading-dialog").popup("close");
		
		//$("#area-alert-dialog").popup("open");
		
		if (alertdialog_ok_lastcallback) {
			$("#master-alert-dialog-button-ok").css({"display": "block"});
		} else {
			$("#master-alert-dialog-button-ok").css({"display": "none"});
		}
		
			}

		function okAlertDialog() {
			closePopupMenu();
			//$("#area-alert-dialog").popup("close");
			alertdialog_ok_lastcallback();
		}
		
		function closeAlertDialog() {
			closePopupMenu();
			
			$("#area-loading-dialog").popup("close");
		}
		
		function hideAlertDialogButtonOnce() {
			$("#master-alert-dialog-button-ok").css({"display": "none"});
		}
     </script>
     <div data-overlay-theme="b" data-role="popup" id="area-input-dialog">
      <div class="popupbox popupbox_auto">
       <div class="normal">
        <div id="area-input-dialog-data">
         <div style="position:relative;">
          <div>
           <input autocapitalize="off" autocomplete="off" class="defborder biginput" data-role="none" id="input-input-dialog" placeholder="" style="" type="text" value=""/>
          </div>
          <div id="area-input-dialog-button-rightbutton-master" style="display:none;position:absolute;right:5px;top:5px;bottom:7px;">
           <div class="buttonborder" style="width:150px;height:100%;">
            <a class="force_center" data-mini="true" data-role="button" data-shadow="false" id="area-input-dialog-button-rightbutton">
            </a>
           </div>
          </div>
         </div>
        </div>
        <div class="noticebox" id="area-input-dialog-caution" style="margin-top:10px;">
        </div>
        <div id="area-input-dialog-footer" style="margin-top:10px;display:none;">
        </div>
        <div class="horizontal" style="padding-top:10px;justify-content: flex-end;">
         <div class="buttonborder" style="width:150px;">
          <a class="force_center" data-role="button" data-shadow="false" id="area-input-dialog-button-ok">
           <b>
            OK
           </b>
          </a>
         </div>
         <div class="buttonborder" style="width:150px;margin-left:10px;">
          <a class="force_center" data-role="button" data-shadow="false" id="area-input-dialog-button-cancel">
           キャンセル
          </a>
         </div>
        </div>
        <script>
         $('#area-input-dialog-button-ok').on('click', function(){
				    okInputDialog();
				    return false;
				});
				$('#area-input-dialog-button-cancel').on('click', function(){
				    cancelInputDialog();
				    return false;
				});
				$('#area-input-dialog-button-rightbutton').on('click', function(){
				    rightbuttonInputDialog();
				    return false;
				});
        </script>
       </div>
      </div>
     </div>
     <script>
      var inputdialog_ok_lastcallback = false;
	var inputdialog_cancel_lastcallback = false;
	var inputdialog_rightbutton_lastcallback = false;
	var inputdialog_detail = false;
	function openInputDialog(_title, _value, _caution, _callback_ok, _callback_cancel, _detail) {
		inputdialog_ok_lastcallback = _callback_ok;
		inputdialog_cancel_lastcallback = _callback_cancel;
		
		$("#input-input-dialog").val(_value);
		$("#input-input-dialog").attr("placeholder", _title);
		
		if (_caution) {
			$("#area-input-dialog-caution").html(_caution).trigger("create");
			$("#area-input-dialog-caution").css("display", "block");
		} else {
			$("#area-input-dialog-caution").css("display", "none");
		}
		
		inputdialog_detail = _detail;
		$("#area-input-dialog-button-rightbutton-master").css("display", "none");
		$("#area-input-dialog-footer").css("display", "none");
		if (_detail) {
			if (_detail["rightbutton"]) {
				$("#area-input-dialog-button-rightbutton-master").css("display", "block");
				if (_detail["rightbutton"]["label"]) {
					$("#area-input-dialog-button-rightbutton").text(_detail["rightbutton"]["label"]);
				}
				inputdialog_rightbutton_lastcallback = _detail["rightbutton"]["callback"];
			}
			if (_detail["footer"]) {
				$("#area-input-dialog-footer").html(_detail["footer"]).trigger("create");
				$("#area-input-dialog-footer").css("display", "block");
			}
		}
		if (rightbuttonInputDialog_timeoutHandler) {
			clearTimeout(rightbuttonInputDialog_timeoutHandler);
			rightbuttonInputDialog_timeoutHandler = false;
		}
		$("#area-input-dialog-button-rightbutton-master").css("opacity", "1");
		
		openPopupMenu("#area-input-dialog");
		
		$("#input-input-dialog").focus();
	}
	
		var rightbuttonInputDialog_timeoutHandler = false;
		function rightbuttonInputDialog() {
			if (inputdialog_detail) {
				if (inputdialog_detail["rightbutton"]) {
					if (inputdialog_detail["rightbutton"]["timeout"]) {
						if (rightbuttonInputDialog_timeoutHandler) {
							return false;
						}
						$("#area-input-dialog-button-rightbutton-master").css("opacity", "0.3");
						clearTimeout(rightbuttonInputDialog_timeoutHandler);
						rightbuttonInputDialog_timeoutHandler = setTimeout(function(){
							rightbuttonInputDialog_timeoutHandler = false;
							$("#area-input-dialog-button-rightbutton-master").css("opacity", "1");
						}, inputdialog_detail["rightbutton"]["timeout"]);
					}
				}
			}
			inputdialog_rightbutton_lastcallback($("#input-input-dialog").val());
		}
	
		function okInputDialog() {
			if (inputdialog_detail) {
				if (inputdialog_detail["require_input"]) {
					if ($("#input-input-dialog").val() == "") {
						return;
					}
				}
			}
			
			$("#input-input-dialog").blur();
			closePopupMenu();
			inputdialog_ok_lastcallback($("#input-input-dialog").val());
		}

		function cancelInputDialog() {
			$("#input-input-dialog").blur();
			closePopupMenu();
			inputdialog_cancel_lastcallback();
		}
     </script>
     <script>
      function viewError(_error, _callback_ok) {
					closePopupMenu();
			
			if (_callback_ok) {
				openAlertDialog(_error, _callback_ok);
			} else {
				openAlertDialog(_error, function(){});
			}
			}
     </script>
     <script>
      function clipcopyjs(string){
	  var tmp = document.createElement("div");
	  // 選択用のタグ生成
	  var pre = document.createElement('pre');
	  pre.style.webkitUserSelect = 'auto';
	  pre.style.userSelect = 'auto';

	  tmp.appendChild(pre).textContent = string;
	  var s = tmp.style;
	  s.position = 'fixed';
	  s.right = '200%';
	  document.body.appendChild(tmp);
	  document.getSelection().selectAllChildren(tmp);
	  var result = document.execCommand("copy");
	  document.body.removeChild(tmp);
	  return result;
	}
     </script>
     <input data-role="none" id="clipboard_pass" style="display:none;" type="text" value=""/>
     <script>
      window.onbeforeunload = function(event){
		event = event || window.event;
		if (SaveDataKeep_Status) {
			return event.returnValue = "作成中のメールはまだ送信されておらず、下書きにも保存されていませんが移動してもよろしいですか？";
		} else {
			return;
		}
	}

var SaveDataKeep_Status = false;
function FlexCall(_data) {
	console.log(""+_data);
	var _ent = parseValue(_data);
	if (_ent["action"] == "changeUID") {
		cookie.set('cookie_sessionhash', _ent["new_UID"]);
		location.href = "./";
	} else if (_ent["action"] == "SaveDataKeep") {
		if (_ent["mode"] == "on") {
			SaveDataKeep_Status = true;
		} else {
			SaveDataKeep_Status = false;
		}
	} else if (_ent["action"] == "clipboardCopy" || _ent["action"] == "clipboardCopyEncode") {
		clipcopyjs(""+decodeURIComponent(_ent["text"]));
	} else {
		//alert(""+_data);
	}
}
function ActionWinOpen(_url) {
	if (_url.indexOf("mailto:") != -1) {
		var _tmp = _url.split("mailto:");
		window.open("https://m.kuku.lu/new.php?sendmail_to="+escape(_tmp[1]));
	} else {
		window.open(_url);
	}
}

//更新でなくタブ切り替えのみの場合に発火
var tabRefreshQueues = [];
function tabRefreshQueue(_func) {
	tabRefreshQueues.push(_func);
}
function tabRefresh() {
	if (tabRefreshQueues.length <= 0) return;
	for (var i in tabRefreshQueues) {
		tabRefreshQueues[i]();
	}
}

function androidLoadSuccess() {
}

setTimeout(function(){
	try {
		cookie.set("cookie_timezone", ""+jstz.determine().name());
	} catch(e) {
		console.error("timezone detect: error: "+e);
	}
}, 500);

//ネイティブアラート出す時は'を置き換える
var nativeAlert = window.alert;
window.alert = function(_msg) {
	_msg = _msg.split("&rsquo;").join("'");
	nativeAlert(_msg);
}
     </script>
    </div>
   </div>
  </div>
  <div style="width:100%;min-height:90px;">
   <div style="margin:auto;padding-top:10px;overflow:hidden;text-align:center;">
    <script async="" src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js">
    </script>
    <!-- 捨てメアドR 下部 -->
    <ins class="adsbygoogle" data-ad-client="ca-pub-6235967741013519" data-ad-format="horizontal" data-ad-slot="9314403969" data-full-width-responsive="true" sandbox="allow-forms allow-pointer-lock allow-popups allow-popups-to-escape-sandbox allow-same-origin allow-scripts allow-top-navigation-by-user-activation" style="display:block">
    </ins>
    <script>
     (adsbygoogle = window.adsbygoogle || []).push({});
    </script>
   </div>
  </div>
  <div id="fullfooter">
   <div class="font_gray" style="text-align:center;font-size:12px;">
    <br/>
    <div style="font-size:12px;text-align:center;">
     <a href="https://chrome.google.com/webstore/detail/%E6%8D%A8%E3%81%A6%E3%83%A1%E3%82%A2%E3%83%89-for-chrome/ephdkjannbbaocplebkfnnnimphfpigj" target="_blank">
      新着メールお知らせ拡張機能はこちら (for Chrome)
     </a>
    </div>
    <br/>
    <div>
     <b>
      日本語
     </b>
     |
     <a href="en.php">
      English
     </a>
     |
     <a href="ko.php">
      한국어
     </a>
     |
     <a href="cn.php">
      简体中文
     </a>
     |
     <a href="tw.php">
      繁體中文
     </a>
     |
     <a href="hi.php">
      हिंदी
     </a>
     |
     <a href="tr.php">
      Türkçe
     </a>
     |
     <a href="id.php">
      Indonesia
     </a>
     |
     <a href="es.php">
      Español
     </a>
     |
     <a href="ru.php">
      Русский
     </a>
     |
     <a href="pt.php">
      Português
     </a>
     |
     <a href="fr.php">
      Français
     </a>
     |
     <a href="de.php">
      Deutsch
     </a>
     |
     <a href="ar.php">
      العربية
     </a>
     |
     <a href="it.php">
      Italiano
     </a>
    </div>
    <br/>
    <div style="text-align:center;padding:5px;">
     <a href="https://m.kuku.lu/rule.php" target="_blank">
      利用規約
     </a>
     |
     <a href="https://status.aquapal.net/" target="_blank">
      稼働状況
     </a>
     |
     <a href="https://m.kuku.lu/help.php">
      ヘルプとサポート
     </a>
    </div>
    <br/>
    <div>
     <a href="https://aquapal.net/" target="_blank">
      <img border="0" src="img/aquapal.png"/>
     </a>
    </div>
    <br/>
    <!-- ここからIFRAMEを動かすとバグるので注意 -->
    <iframe frameborder="0" height="1" id="actionwin" name="actionwin" scrolling="NO" src="about:blank" width="1">
    </iframe>
    © 捨てメアド【メルアドぽいぽい】
    <br/>
    Powered by
    <a href="https://twitter.com/kukusama" target="_blank">
     @kukusama
    </a>
    .
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
    <br/>
   </div>
  </div>
  <!--
[internal processing times]

@ APIProc-0: 0.0001 sec
@ APIProc-0-a: 0 sec
@ APIProc-0-b: 0 sec
@ APIProc-0-c: 0 sec
@ APIProc-1: 0 sec
@ APIProc-2: 0 sec
@ APIProc-3: 0 sec
@ APIProc-4: 0 sec
@ APIProc-5: 0.0005 sec
@ APIProc-7: 0.0013 sec
@ APIProc-8: 0.2167 sec
@ APIProc-9: 0.008 sec
@ APIProc-10: 0 sec

= total: 0.2266 sec
-->
 </body>
</html>
